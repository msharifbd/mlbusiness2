<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title> Chapter # 04   Logistic Regression – Machine Learning in Business</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap05_discriminant.html" rel="next">
<link href="./chap03_knn.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/siuc2.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Machine Learning in Business</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus/bsan405.pdf"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./books.html"> 
<span class="menu-text">Books</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./moduels.html" aria-current="page"> 
<span class="menu-text">Modules &amp; Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./readings.html"> 
<span class="menu-text">Readings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./other-materials.html"> 
<span class="menu-text">Others</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./recent-developments.html"> 
<span class="menu-text">Blogs</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap03_knn.html">Supervised ML Algorithm</a></li><li class="breadcrumb-item"><a href="./chap04_logistic.html"><center> Chapter # 04 <br> Logistic Regression</center></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./moduels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modules &amp; Slides</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap01_intro.html" class="sidebar-item-text sidebar-link"> Chapter # 01 <br> Introduction to Machine Learning</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap02_RpythonEDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap02_RpythonEDA.html" class="sidebar-item-text sidebar-link"> Chapter # 02 <br> An Introduction to R and Python</a>
  </center></div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Supervised ML Algorithm</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap03_knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap03_knn.html" class="sidebar-item-text sidebar-link"> Chapter # 03 <br> K Nearest Neighbor (KNN) Algorithm</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap04_logistic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"></span></a><center><a href="./chap04_logistic.html" class="sidebar-item-text sidebar-link active"> Chapter # 04 <br> Logistic Regression</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap05_discriminant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap05_discriminant.html" class="sidebar-item-text sidebar-link"> Chapter # 05 <br> Discriminant Analysis</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap06_naive_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap06_naive_bayes.html" class="sidebar-item-text sidebar-link"> Chapter # 06 (Part A) <br> Naive Bayes</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap06_svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap06_svm.html" class="sidebar-item-text sidebar-link"> Chapter # 06 (Part B) <br> Support Vector Machine (SVM)</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap07_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap07_regression.html" class="sidebar-item-text sidebar-link"> Chapter # 07 <br> Regression Analysis</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap08_decision_tree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap08_decision_tree.html" class="sidebar-item-text sidebar-link"> Chapter # 08 <br> Decision Tree</a>
  </center></div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Unsupervised ML Algorithm</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap09_pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap09_pca.html" class="sidebar-item-text sidebar-link"> Chapter # 09 <br> Dimension Reduction &amp; PCA</a>
  </center></div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Clustering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap10_kmeansclustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap10_kmeansclustering.html" class="sidebar-item-text sidebar-link"> Chapter # 10 <br> K-means Clustering</a>
  </center></div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./r_eda.html" class="sidebar-item-text sidebar-link"> Exploratory Data Analysis in R</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./python_eda.html" class="sidebar-item-text sidebar-link"> Exploratory Data Analysis in Python</a>
  </center></div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap01_slide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap01_slide.html" class="sidebar-item-text sidebar-link"> Chapter # 01 <br> Introduction to Machine Learning</a>
  </center></div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap03_slide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"></span></a><center><a href="./chap03_slide.html" class="sidebar-item-text sidebar-link"> Chapter # 03 <br> K Nearest Neighbor (KNN)</a>
  </center></div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#loading-python-package" id="toc-loading-python-package" class="nav-link" data-scroll-target="#loading-python-package"><span class="header-section-number">2</span> Loading Python Package</a></li>
  <li><a href="#loading-dataset" id="toc-loading-dataset" class="nav-link" data-scroll-target="#loading-dataset"><span class="header-section-number">3</span> Loading Dataset</a>
  <ul>
  <li><a href="#metadata-of-the-dataset" id="toc-metadata-of-the-dataset" class="nav-link" data-scroll-target="#metadata-of-the-dataset"><span class="header-section-number">3.1</span> Metadata of the Dataset</a></li>
  </ul></li>
  <li><a href="#data-quality-missing-value-assessment" id="toc-data-quality-missing-value-assessment" class="nav-link" data-scroll-target="#data-quality-missing-value-assessment"><span class="header-section-number">4</span> Data Quality &amp; Missing Value Assessment</a>
  <ul>
  <li><a href="#age---missing-value" id="toc-age---missing-value" class="nav-link" data-scroll-target="#age---missing-value"><span class="header-section-number">4.1</span> Age - Missing Value</a></li>
  <li><a href="#cabin---missing-value" id="toc-cabin---missing-value" class="nav-link" data-scroll-target="#cabin---missing-value"><span class="header-section-number">4.2</span> Cabin - Missing Value</a></li>
  <li><a href="#embarked---missing-value" id="toc-embarked---missing-value" class="nav-link" data-scroll-target="#embarked---missing-value"><span class="header-section-number">4.3</span> Embarked - Missing Value</a></li>
  </ul></li>
  <li><a href="#final-adjustment-to-the-datasets-training-testing" id="toc-final-adjustment-to-the-datasets-training-testing" class="nav-link" data-scroll-target="#final-adjustment-to-the-datasets-training-testing"><span class="header-section-number">5</span> Final Adjustment to the Datasets (Training &amp; Testing)</a>
  <ul>
  <li><a href="#additional-variables" id="toc-additional-variables" class="nav-link" data-scroll-target="#additional-variables"><span class="header-section-number">5.1</span> Additional Variables</a></li>
  <li><a href="#creating-new-variables" id="toc-creating-new-variables" class="nav-link" data-scroll-target="#creating-new-variables"><span class="header-section-number">5.2</span> Creating New Variables</a>
  <ul>
  <li><a href="#creating-the-dummies-for-categorical-variables" id="toc-creating-the-dummies-for-categorical-variables" class="nav-link" data-scroll-target="#creating-the-dummies-for-categorical-variables"><span class="header-section-number">5.2.1</span> Creating the Dummies for Categorical Variables</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda"><span class="header-section-number">6</span> Exploratory Data Analysis (EDA)</a>
  <ul>
  <li><a href="#exploration-of-age-variable" id="toc-exploration-of-age-variable" class="nav-link" data-scroll-target="#exploration-of-age-variable"><span class="header-section-number">6.1</span> Exploration of <code>Age</code> Variable</a></li>
  <li><a href="#exploration-of-fare-variable" id="toc-exploration-of-fare-variable" class="nav-link" data-scroll-target="#exploration-of-fare-variable"><span class="header-section-number">6.2</span> Exploration of <code>Fare</code> Variable</a></li>
  <li><a href="#exploration-of-pclass-variable" id="toc-exploration-of-pclass-variable" class="nav-link" data-scroll-target="#exploration-of-pclass-variable"><span class="header-section-number">6.3</span> Exploration of <code>PClass</code> Variable</a></li>
  <li><a href="#exploration-of-embarked-variable" id="toc-exploration-of-embarked-variable" class="nav-link" data-scroll-target="#exploration-of-embarked-variable"><span class="header-section-number">6.4</span> Exploration of <code>Embarked</code> Variable</a></li>
  <li><a href="#exploration-of-travelalone-variable" id="toc-exploration-of-travelalone-variable" class="nav-link" data-scroll-target="#exploration-of-travelalone-variable"><span class="header-section-number">6.5</span> Exploration of <code>TravelAlone</code> Variable</a></li>
  <li><a href="#exploration-of-gender-variable" id="toc-exploration-of-gender-variable" class="nav-link" data-scroll-target="#exploration-of-gender-variable"><span class="header-section-number">6.6</span> Exploration of <code>Gender</code> Variable</a></li>
  <li><a href="#chi-square-test-of-independence" id="toc-chi-square-test-of-independence" class="nav-link" data-scroll-target="#chi-square-test-of-independence"><span class="header-section-number">6.7</span> Chi-square Test of Independence</a>
  <ul>
  <li><a href="#chi-square-test-of-independence-betweeen-survived-and-sex" id="toc-chi-square-test-of-independence-betweeen-survived-and-sex" class="nav-link" data-scroll-target="#chi-square-test-of-independence-betweeen-survived-and-sex"><span class="header-section-number">6.7.1</span> Chi-square Test of Independence betweeen <code>Survived</code> and <code>Sex</code></a></li>
  <li><a href="#chi-square-test-of-independence-betweeen-survived-and-pclass" id="toc-chi-square-test-of-independence-betweeen-survived-and-pclass" class="nav-link" data-scroll-target="#chi-square-test-of-independence-betweeen-survived-and-pclass"><span class="header-section-number">6.7.2</span> Chi-square Test of Independence betweeen <code>Survived</code> and <code>Pclass</code></a></li>
  </ul></li>
  <li><a href="#post-hoc-analysis-of-pclass" id="toc-post-hoc-analysis-of-pclass" class="nav-link" data-scroll-target="#post-hoc-analysis-of-pclass"><span class="header-section-number">6.8</span> Post Hoc Analysis of <code>Pclass</code></a></li>
  <li><a href="#post-hoc-analysis-of-embarked" id="toc-post-hoc-analysis-of-embarked" class="nav-link" data-scroll-target="#post-hoc-analysis-of-embarked"><span class="header-section-number">6.9</span> Post Hoc Analysis of <code>Embarked</code></a></li>
  </ul></li>
  <li><a href="#logistic-regression-results" id="toc-logistic-regression-results" class="nav-link" data-scroll-target="#logistic-regression-results"><span class="header-section-number">7</span> Logistic Regression &amp; Results</a>
  <ul>
  <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection"><span class="header-section-number">7.1</span> Feature Selection</a>
  <ul>
  <li><a href="#recursive-feature-selection-rfe" id="toc-recursive-feature-selection-rfe" class="nav-link" data-scroll-target="#recursive-feature-selection-rfe"><span class="header-section-number">7.1.1</span> Recursive Feature Selection (RFE)</a></li>
  <li><a href="#feature-ranking-with-recursive-feature-elimination-and-cross-validation-rfecv" id="toc-feature-ranking-with-recursive-feature-elimination-and-cross-validation-rfecv" class="nav-link" data-scroll-target="#feature-ranking-with-recursive-feature-elimination-and-cross-validation-rfecv"><span class="header-section-number">7.1.2</span> Feature Ranking with Recursive Feature Elimination and Cross-validation (<code>RFECV</code>)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix"><span class="header-section-number">8</span> Correlation Matrix</a></li>
  <li><a href="#model-evaluation-procedures" id="toc-model-evaluation-procedures" class="nav-link" data-scroll-target="#model-evaluation-procedures"><span class="header-section-number">9</span> Model Evaluation Procedures</a>
  <ul>
  <li><a href="#model-evaluation-based-on-traintest-split" id="toc-model-evaluation-based-on-traintest-split" class="nav-link" data-scroll-target="#model-evaluation-based-on-traintest-split"><span class="header-section-number">9.1</span> Model Evaluation Based on Train/Test Split</a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix"><span class="header-section-number">9.2</span> Confusion Matrix</a></li>
  <li><a href="#classification-report" id="toc-classification-report" class="nav-link" data-scroll-target="#classification-report"><span class="header-section-number">9.3</span> Classification Report</a></li>
  <li><a href="#roc-auc-curve" id="toc-roc-auc-curve" class="nav-link" data-scroll-target="#roc-auc-curve"><span class="header-section-number">9.4</span> ROC-AUC Curve</a></li>
  </ul></li>
  <li><a href="#model-evaluation-based-on-k-fold-cross-validation-cross_val_score-function" id="toc-model-evaluation-based-on-k-fold-cross-validation-cross_val_score-function" class="nav-link" data-scroll-target="#model-evaluation-based-on-k-fold-cross-validation-cross_val_score-function"><span class="header-section-number">10</span> Model Evaluation Based on K-fold Cross-validation <code>cross_val_score()</code> Function</a>
  <ul>
  <li><a href="#model-evaluation-based-on-k-fold-cross-validation-using-cross_validate-function" id="toc-model-evaluation-based-on-k-fold-cross-validation-using-cross_validate-function" class="nav-link" data-scroll-target="#model-evaluation-based-on-k-fold-cross-validation-using-cross_validate-function"><span class="header-section-number">10.1</span> Model Evaluation Based on K-fold Cross-validation Using <code>cross_validate()</code> Function</a></li>
  </ul></li>
  <li><a href="#gridsearchcv-evaluating-using-multiple-scorers-simultaneously" id="toc-gridsearchcv-evaluating-using-multiple-scorers-simultaneously" class="nav-link" data-scroll-target="#gridsearchcv-evaluating-using-multiple-scorers-simultaneously"><span class="header-section-number">11</span> <code>GridSearchCV</code> Evaluating Using Multiple Scorers Simultaneously</a>
  <ul>
  <li><a href="#gridsearchcv-evaluating-using-multiple-scorers-repeatedstratifiedkfold-and-pipeline-for-preprocessing-simultaneously" id="toc-gridsearchcv-evaluating-using-multiple-scorers-repeatedstratifiedkfold-and-pipeline-for-preprocessing-simultaneously" class="nav-link" data-scroll-target="#gridsearchcv-evaluating-using-multiple-scorers-repeatedstratifiedkfold-and-pipeline-for-preprocessing-simultaneously"><span class="header-section-number">11.1</span> <code>GridSearchCV</code> Evaluating Using Multiple scorers, <code>RepeatedStratifiedKFold</code> and <code>pipeline</code> for Preprocessing Simultaneously</a></li>
  </ul></li>
  <li><a href="#regularization" id="toc-regularization" class="nav-link" data-scroll-target="#regularization"><span class="header-section-number">12</span> Regularization</a>
  <ul>
  <li><a href="#types-of-regularization" id="toc-types-of-regularization" class="nav-link" data-scroll-target="#types-of-regularization"><span class="header-section-number">12.1</span> Types of Regularization</a>
  <ul>
  <li><a href="#l1-regularization" id="toc-l1-regularization" class="nav-link" data-scroll-target="#l1-regularization"><span class="header-section-number">12.1.1</span> <code>L1</code> regularization</a></li>
  <li><a href="#l2-regularization" id="toc-l2-regularization" class="nav-link" data-scroll-target="#l2-regularization"><span class="header-section-number">12.1.2</span> <code>L2</code> regularization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">13</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap03_knn.html">Supervised ML Algorithm</a></li><li class="breadcrumb-item"><a href="./chap04_logistic.html"><center> Chapter # 04 <br> Logistic Regression</center></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><center><br>
Chapter # 04 <br> Logistic Regression</center></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
</section>
<section id="loading-python-package" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="loading-python-package"><span class="header-section-number">2</span> Loading Python Package</h2>
<div id="0da96a99" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For Visualization</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">"white"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">"whitegrid"</span>, color_codes <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn <span class="co"># For Machine Learning </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>sys.version</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">'The Scikit-learn version that is used for this code file is </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(sklearn.__version__))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The Scikit-learn version that is used for this code file is 1.6.0</code></pre>
</div>
</div>
</section>
<section id="loading-dataset" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="loading-dataset"><span class="header-section-number">3</span> Loading Dataset</h2>
<div id="ea01a69b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing Training Dataset </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> pd.read_csv(<span class="st">"DATA/train.csv"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing Testing Dataset</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> pd.read_csv(<span class="st">"DATA/test.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="metadata-of-the-dataset" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="metadata-of-the-dataset"><span class="header-section-number">3.1</span> Metadata of the Dataset</h3>
<div id="aeb667e6" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The total number of rows and columns in the dataset is </span><span class="sc">{}</span><span class="st"> and </span><span class="sc">{}</span><span class="st"> respectively."</span>.<span class="bu">format</span>(train_df.shape[<span class="dv">0</span>],train_df.shape[<span class="dv">1</span>]))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"</span><span class="ch">\n</span><span class="st">The names and the types of the variables of the dataset:"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>train_df.info()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>train_df.head()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The types of the variables in the dataset are:"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>train_df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The total number of rows and columns in the dataset is 891 and 12 respectively.

The names and the types of the variables of the dataset:
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB

The types of the variables in the dataset are:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>PassengerId      int64
Survived         int64
Pclass           int64
Name            object
Sex             object
Age            float64
SibSp            int64
Parch            int64
Ticket          object
Fare           float64
Cabin           object
Embarked        object
dtype: object</code></pre>
</div>
</div>
<div id="e06e63e0" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> train_df.columns:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>  (x)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>train_df[<span class="st">'Pclass'</span>].value_counts(sort <span class="op">=</span> <span class="va">True</span>, ascending <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PassengerId
Survived
Pclass
Name
Sex
Age
SibSp
Parch
Ticket
Fare
Cabin
Embarked</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Pclass
2    184
1    216
3    491
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cebb8ab4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>train_df[<span class="st">'Sex'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Sex
male      577
female    314
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
</section>
<section id="data-quality-missing-value-assessment" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="data-quality-missing-value-assessment"><span class="header-section-number">4</span> Data Quality &amp; Missing Value Assessment</h2>
<div id="7423e90c" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing value in Training Dataset </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train_df.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            177
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64</code></pre>
</div>
</div>
<div id="952579fe" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing value in Testing Dataset </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>test_df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>PassengerId      0
Pclass           0
Name             0
Sex              0
Age             86
SibSp            0
Parch            0
Ticket           0
Fare             1
Cabin          327
Embarked         0
dtype: int64</code></pre>
</div>
</div>
<section id="age---missing-value" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="age---missing-value"><span class="header-section-number">4.1</span> Age - Missing Value</h3>
<div id="e89301cc" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">'The percent of missing "Age" record in the training dataset is </span><span class="sc">%0.2f%%</span><span class="st">'</span> <span class="op">%</span>(train_df[<span class="st">'Age'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span>train_df.shape[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The percent of missing "Age" record in the training dataset is 19.87%</code></pre>
</div>
</div>
<div id="a690146d" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">'The percent of missing "Age" record in testing dataset is </span><span class="sc">%0.3f%%</span><span class="st">'</span> <span class="op">%</span>(test_df[<span class="st">'Age'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span>test_df.shape[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The percent of missing "Age" record in testing dataset is 20.574%</code></pre>
</div>
</div>
<div id="0b07f7dd" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>train_df[<span class="st">'Age'</span>].hist(bins <span class="op">=</span> <span class="dv">15</span>, density <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'teal'</span>, alpha <span class="op">=</span> <span class="fl">0.60</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>train_df[<span class="st">'Age'</span>].plot(kind <span class="op">=</span> <span class="st">'density'</span>, color <span class="op">=</span> <span class="st">'teal'</span>, alpha <span class="op">=</span> <span class="fl">0.60</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-11-output-1.png" width="833" height="639" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Since the variable <code>Age</code> is a little bit right skewed, using the mean to replace the missing observations might bias our results. Therefore, it is recommended that median be used to replace the missing observations.</p>
<div id="41a27d70" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">'The mean of "Age" variable is </span><span class="sc">%0.3f</span><span class="st">.'</span> <span class="op">%</span>(train_df[<span class="st">'Age'</span>].mean(skipna <span class="op">=</span> <span class="va">True</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean of "Age" variable is 29.699.</code></pre>
</div>
</div>
<div id="f63f1fff" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">'The median of "Age" variable is </span><span class="sc">%0.2f</span><span class="st">.'</span> <span class="op">%</span>(train_df[<span class="st">'Age'</span>].median(skipna <span class="op">=</span> <span class="va">True</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The median of "Age" variable is 28.00.</code></pre>
</div>
</div>
</section>
<section id="cabin---missing-value" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="cabin---missing-value"><span class="header-section-number">4.2</span> Cabin - Missing Value</h3>
<div id="9a135d74" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>train_df[<span class="st">'Cabin'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Cabin
G6             4
C23 C25 C27    4
B96 B98        4
F2             3
D              3
              ..
E17            1
A24            1
C50            1
B42            1
C148           1
Name: count, Length: 147, dtype: int64</code></pre>
</div>
</div>
<div id="7bb8ed38" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">'The percent of cabin variable missing value is </span><span class="sc">%0.2f%%</span><span class="st">.'</span> <span class="op">%</span>(train_df[<span class="st">'Cabin'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span>train_df.shape[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The percent of cabin variable missing value is 77.10%.</code></pre>
</div>
</div>
<p>77% observations of the <code>Cabin</code> variable is missing. Therefore, it is better to prune the variable from the dataset. Moreover, the drop of the <code>Cabin</code> variable is justified because it has correlation with two other variables - <code>Fare</code> and <code>Pclass</code>.</p>
</section>
<section id="embarked---missing-value" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="embarked---missing-value"><span class="header-section-number">4.3</span> Embarked - Missing Value</h3>
<div id="8d61b98f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>train_df[<span class="st">'Embarked'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>Embarked
S    644
C    168
Q     77
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="aec97e93" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent of missing 'Embarked' Variable</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The percent of missing 'Embarked' records is </span><span class="sc">%.2f%%</span><span class="st">"</span> <span class="op">%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    (train_df[<span class="st">'Embarked'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span>train_df.shape[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The percent of missing 'Embarked' records is 0.22%</code></pre>
</div>
</div>
<p>Since there are only 0.22% missing observation for <code>Embarked</code>, we can impute the missing values with the port where most people embarked.</p>
<div id="6d7fa346" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Boarded passengers grouped by port of embarkation (C = Cherbourg, Q = Queenstown, S = Southampton):'</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_df[<span class="st">'Embarked'</span>].value_counts())</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'Embarked'</span>, data<span class="op">=</span>train_df, palette<span class="op">=</span><span class="st">'Set2'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Boarded passengers grouped by port of embarkation (C = Cherbourg, Q = Queenstown, S = Southampton):
Embarked
S    644
C    168
Q     77
Name: count, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-18-output-2.png" width="597" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="be9046cc" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The most common boarding port of embarkation is </span><span class="sc">%s</span><span class="st">.'</span> <span class="op">%</span>train_df[<span class="st">'Embarked'</span>].value_counts().idxmax())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The most common boarding port of embarkation is S.</code></pre>
</div>
</div>
</section>
</section>
<section id="final-adjustment-to-the-datasets-training-testing" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="final-adjustment-to-the-datasets-training-testing"><span class="header-section-number">5</span> Final Adjustment to the Datasets (Training &amp; Testing)</h2>
<p>Based on the assessment of the missing values in the dataset, We will make the following changes to the data:</p>
<ul>
<li>The missing value of <code>Age</code> variable will be imputed with 28 (median value <code>Age</code>)</li>
<li>The missing value of <code>Embarked</code> variable will be imputed with <code>S</code> (the most common boarding point)</li>
<li>There are many missing values for the variable <code>Cabin</code>; therefore, the variable will be dropped. Moreover, the drop will not affect the model as the variable is associated with two other variables - <code>Pclass</code> and <code>Fare</code>.</li>
</ul>
<div id="2ca38bf5" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_df.copy()</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>train_data[<span class="st">'Age'</span>].fillna(train_data[<span class="st">'Age'</span>].median(skipna <span class="op">=</span> <span class="va">True</span>), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>train_data[<span class="st">'Embarked'</span>].fillna(train_data[<span class="st">'Embarked'</span>].value_counts().idxmax(), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>train_data.drop([<span class="st">'Cabin'</span>], axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>train_data.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>PassengerId    0
Survived       0
Pclass         0
Name           0
Sex            0
Age            0
SibSp          0
Parch          0
Ticket         0
Fare           0
Embarked       0
dtype: int64</code></pre>
</div>
</div>
<div id="e7b616ad" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>train_data.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">886</td>
<td>887</td>
<td>0</td>
<td>2</td>
<td>Montvila, Rev. Juozas</td>
<td>male</td>
<td>27.0</td>
<td>0</td>
<td>0</td>
<td>211536</td>
<td>13.00</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">887</td>
<td>888</td>
<td>1</td>
<td>1</td>
<td>Graham, Miss. Margaret Edith</td>
<td>female</td>
<td>19.0</td>
<td>0</td>
<td>0</td>
<td>112053</td>
<td>30.00</td>
<td>S</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">888</td>
<td>889</td>
<td>0</td>
<td>3</td>
<td>Johnston, Miss. Catherine Helen "Carrie"</td>
<td>female</td>
<td>28.0</td>
<td>1</td>
<td>2</td>
<td>W./C. 6607</td>
<td>23.45</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">889</td>
<td>890</td>
<td>1</td>
<td>1</td>
<td>Behr, Mr. Karl Howell</td>
<td>male</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>111369</td>
<td>30.00</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">890</td>
<td>891</td>
<td>0</td>
<td>3</td>
<td>Dooley, Mr. Patrick</td>
<td>male</td>
<td>32.0</td>
<td>0</td>
<td>0</td>
<td>370376</td>
<td>7.75</td>
<td>Q</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="9098a48f" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Data with missing observations</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> train_df[<span class="st">'Age'</span>].hist(bins <span class="op">=</span> <span class="dv">15</span>, density <span class="op">=</span> <span class="va">True</span>, stacked <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'teal'</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>train_df[<span class="st">'Age'</span>].plot(kind <span class="op">=</span> <span class="st">'density'</span>, color <span class="op">=</span> <span class="st">'teal'</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data without missing observations</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> train_data[<span class="st">'Age'</span>].hist(bins <span class="op">=</span> <span class="dv">15</span>, density <span class="op">=</span> <span class="va">True</span>, stacked <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'orange'</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>train_data[<span class="st">'Age'</span>].plot(kind <span class="op">=</span> <span class="st">'density'</span>, color <span class="op">=</span> <span class="st">'orange'</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">10</span>,<span class="dv">85</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">"Raw Age"</span>, <span class="st">"Adjusted Age"</span>])</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">'Age'</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-22-output-1.png" width="1196" height="657" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="additional-variables" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="additional-variables"><span class="header-section-number">5.1</span> Additional Variables</h3>
<p>The variable <code>SibSp</code> means whether the passenger has sibling or spouse aboard and the variable <code>Parch</code> means whether the passenger has parents or children aboard. For the sake of simplicity and to account for <strong>multicollinearity</strong>, these two variables will be combined into a categorical variable: whether or not the individual was traveling alone.</p>
<div id="646c6b50" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating categorical variable for Traveling alone</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>train_data[<span class="st">'TravelAlone'</span>] <span class="op">=</span> np.where((train_data[<span class="st">'SibSp'</span>]<span class="op">+</span>train_data[<span class="st">'Parch'</span>]) <span class="op">&gt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>train_data.drop(<span class="st">'SibSp'</span>, axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>train_data.drop(<span class="st">'Parch'</span>, axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For variables <code>Pclass</code>, <code>Sex</code>, and <code>Embarked</code>, categorical variables will be created</p>
<div id="613fb352" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>training <span class="op">=</span> pd.get_dummies(train_data, columns<span class="op">=</span> [<span class="st">"Pclass"</span>, <span class="st">"Embarked"</span>, <span class="st">"Sex"</span>])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>training.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 15 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Name         891 non-null    object 
 3   Age          891 non-null    float64
 4   Ticket       891 non-null    object 
 5   Fare         891 non-null    float64
 6   TravelAlone  891 non-null    int64  
 7   Pclass_1     891 non-null    bool   
 8   Pclass_2     891 non-null    bool   
 9   Pclass_3     891 non-null    bool   
 10  Embarked_C   891 non-null    bool   
 11  Embarked_Q   891 non-null    bool   
 12  Embarked_S   891 non-null    bool   
 13  Sex_female   891 non-null    bool   
 14  Sex_male     891 non-null    bool   
dtypes: bool(8), float64(2), int64(3), object(2)
memory usage: 55.8+ KB</code></pre>
</div>
</div>
<div id="f9aa176c" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>training[[<span class="st">'Pclass_1'</span>,<span class="st">'Pclass_2'</span>,<span class="st">'Pclass_3'</span>, <span class="st">'Embarked_C'</span>,<span class="st">'Embarked_Q'</span>,<span class="st">'Embarked_S'</span>, <span class="st">'Sex_female'</span>, <span class="st">'Sex_male'</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Pclass_1</th>
<th data-quarto-table-cell-role="th">Pclass_2</th>
<th data-quarto-table-cell-role="th">Pclass_3</th>
<th data-quarto-table-cell-role="th">Embarked_C</th>
<th data-quarto-table-cell-role="th">Embarked_Q</th>
<th data-quarto-table-cell-role="th">Embarked_S</th>
<th data-quarto-table-cell-role="th">Sex_female</th>
<th data-quarto-table-cell-role="th">Sex_male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6db8fde7" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>training.drop([<span class="st">'Sex_female'</span>, <span class="st">'PassengerId'</span>, <span class="st">'Name'</span>, <span class="st">'Ticket'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>training.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">TravelAlone</th>
<th data-quarto-table-cell-role="th">Pclass_1</th>
<th data-quarto-table-cell-role="th">Pclass_2</th>
<th data-quarto-table-cell-role="th">Pclass_3</th>
<th data-quarto-table-cell-role="th">Embarked_C</th>
<th data-quarto-table-cell-role="th">Embarked_Q</th>
<th data-quarto-table-cell-role="th">Embarked_S</th>
<th data-quarto-table-cell-role="th">Sex_male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">886</td>
<td>0</td>
<td>27.0</td>
<td>13.00</td>
<td>1</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">887</td>
<td>1</td>
<td>19.0</td>
<td>30.00</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">888</td>
<td>0</td>
<td>28.0</td>
<td>23.45</td>
<td>0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">889</td>
<td>1</td>
<td>26.0</td>
<td>30.00</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">890</td>
<td>0</td>
<td>32.0</td>
<td>7.75</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6607e2a2" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>training.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 11 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   Survived     891 non-null    int64  
 1   Age          891 non-null    float64
 2   Fare         891 non-null    float64
 3   TravelAlone  891 non-null    int64  
 4   Pclass_1     891 non-null    bool   
 5   Pclass_2     891 non-null    bool   
 6   Pclass_3     891 non-null    bool   
 7   Embarked_C   891 non-null    bool   
 8   Embarked_Q   891 non-null    bool   
 9   Embarked_S   891 non-null    bool   
 10  Sex_male     891 non-null    bool   
dtypes: bool(7), float64(2), int64(2)
memory usage: 34.1 KB</code></pre>
</div>
</div>
<div id="02dcc241" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>final_train <span class="op">=</span> training</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>final_train.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">TravelAlone</th>
<th data-quarto-table-cell-role="th">Pclass_1</th>
<th data-quarto-table-cell-role="th">Pclass_2</th>
<th data-quarto-table-cell-role="th">Pclass_3</th>
<th data-quarto-table-cell-role="th">Embarked_C</th>
<th data-quarto-table-cell-role="th">Embarked_Q</th>
<th data-quarto-table-cell-role="th">Embarked_S</th>
<th data-quarto-table-cell-role="th">Sex_male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">886</td>
<td>0</td>
<td>27.0</td>
<td>13.00</td>
<td>1</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">887</td>
<td>1</td>
<td>19.0</td>
<td>30.00</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">888</td>
<td>0</td>
<td>28.0</td>
<td>23.45</td>
<td>0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">889</td>
<td>1</td>
<td>26.0</td>
<td>30.00</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">890</td>
<td>0</td>
<td>32.0</td>
<td>7.75</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="19a0fe6d" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>test_df.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>PassengerId      0
Pclass           0
Name             0
Sex              0
Age             86
SibSp            0
Parch            0
Ticket           0
Fare             1
Cabin          327
Embarked         0
dtype: int64</code></pre>
</div>
</div>
<p>Now we apply the same changes in the testing dataset.</p>
<ul>
<li>We will apply to same imputation for <code>Age</code> in the Test data as we did for my Training data (if missing, <code>Age</code> = 28).</li>
<li>We will also remove the <code>Cabin</code> variable from the test data, as we’ve decided not to include it in my analysis.</li>
<li>There were no missing values in the <code>Embarked</code> port variable.</li>
<li>We will add the dummy variables to finalize the test set.</li>
<li>Finally, We will impute the 1 missing value for <code>Fare</code> with the median, 14.45.</li>
</ul>
<div id="eb88eee5" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The median value of "Fare" variable in testing dataset is </span><span class="sc">%0.3f</span><span class="st">.'</span> <span class="op">%</span>(train_df[<span class="st">'Fare'</span>].median(skipna <span class="op">=</span> <span class="va">True</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The median value of "Fare" variable in testing dataset is 14.454.</code></pre>
</div>
</div>
<div id="2c2cb572" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> test_df.copy()</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>test_data[<span class="st">'Age'</span>].fillna(test_data[<span class="st">'Age'</span>].median(skipna <span class="op">=</span> <span class="va">True</span>), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>test_data[<span class="st">'Fare'</span>].fillna(test_data[<span class="st">'Fare'</span>].median(skipna <span class="op">=</span> <span class="va">True</span>), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>test_data.drop([<span class="st">'Cabin'</span>], axis  <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-new-variables" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="creating-new-variables"><span class="header-section-number">5.2</span> Creating New Variables</h3>
<div id="d112525d" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating new variable - TravelAlone</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>test_data[<span class="st">'TravelAlone'</span>]<span class="op">=</span> np.where(test_data[<span class="st">'SibSp'</span>]<span class="op">+</span>test_data[<span class="st">'Parch'</span>]<span class="op">&gt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>test_data.drop([<span class="st">'SibSp'</span>, <span class="st">'Parch'</span>], axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>test_data.sample(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Embarked</th>
<th data-quarto-table-cell-role="th">TravelAlone</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">292</td>
<td>1184</td>
<td>3</td>
<td>Nasr, Mr. Mustafa</td>
<td>male</td>
<td>27.0</td>
<td>2652</td>
<td>7.2292</td>
<td>C</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">62</td>
<td>954</td>
<td>3</td>
<td>Bjorklund, Mr. Ernst Herbert</td>
<td>male</td>
<td>18.0</td>
<td>347090</td>
<td>7.7500</td>
<td>S</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">304</td>
<td>1196</td>
<td>3</td>
<td>McCarthy, Miss. Catherine Katie""</td>
<td>female</td>
<td>27.0</td>
<td>383123</td>
<td>7.7500</td>
<td>Q</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">269</td>
<td>1161</td>
<td>3</td>
<td>Pokrnic, Mr. Mate</td>
<td>male</td>
<td>17.0</td>
<td>315095</td>
<td>8.6625</td>
<td>S</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">159</td>
<td>1051</td>
<td>3</td>
<td>Peacock, Mrs. Benjamin (Edith Nile)</td>
<td>female</td>
<td>26.0</td>
<td>SOTON/O.Q. 3101315</td>
<td>13.7750</td>
<td>S</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="creating-the-dummies-for-categorical-variables" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="creating-the-dummies-for-categorical-variables"><span class="header-section-number">5.2.1</span> Creating the Dummies for Categorical Variables</h4>
<div id="5344e0bc" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>testing <span class="op">=</span> pd.get_dummies(test_data, columns <span class="op">=</span> [<span class="st">'Pclass'</span>, <span class="st">'Sex'</span>, <span class="st">'Embarked'</span>])</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>testing.drop([<span class="st">'Sex_female'</span>,<span class="st">'PassengerId'</span>, <span class="st">'Name'</span>, <span class="st">'Ticket'</span>], axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>testing.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">TravelAlone</th>
<th data-quarto-table-cell-role="th">Pclass_1</th>
<th data-quarto-table-cell-role="th">Pclass_2</th>
<th data-quarto-table-cell-role="th">Pclass_3</th>
<th data-quarto-table-cell-role="th">Sex_male</th>
<th data-quarto-table-cell-role="th">Embarked_C</th>
<th data-quarto-table-cell-role="th">Embarked_Q</th>
<th data-quarto-table-cell-role="th">Embarked_S</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">413</td>
<td>27.0</td>
<td>8.0500</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">414</td>
<td>39.0</td>
<td>108.9000</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">415</td>
<td>38.5</td>
<td>7.2500</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">416</td>
<td>27.0</td>
<td>8.0500</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417</td>
<td>27.0</td>
<td>22.3583</td>
<td>0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b6bf5cd5" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>final_test <span class="op">=</span> testing</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>final_test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">TravelAlone</th>
<th data-quarto-table-cell-role="th">Pclass_1</th>
<th data-quarto-table-cell-role="th">Pclass_2</th>
<th data-quarto-table-cell-role="th">Pclass_3</th>
<th data-quarto-table-cell-role="th">Sex_male</th>
<th data-quarto-table-cell-role="th">Embarked_C</th>
<th data-quarto-table-cell-role="th">Embarked_Q</th>
<th data-quarto-table-cell-role="th">Embarked_S</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>34.5</td>
<td>7.8292</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>47.0</td>
<td>7.0000</td>
<td>0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>62.0</td>
<td>9.6875</td>
<td>1</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>27.0</td>
<td>8.6625</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>22.0</td>
<td>12.2875</td>
<td>0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="exploratory-data-analysis-eda"><span class="header-section-number">6</span> Exploratory Data Analysis (EDA)</h2>
<section id="exploration-of-age-variable" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="exploration-of-age-variable"><span class="header-section-number">6.1</span> Exploration of <code>Age</code> Variable</h3>
<div id="18ec31ae" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>final_train.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 11 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   Survived     891 non-null    int64  
 1   Age          891 non-null    float64
 2   Fare         891 non-null    float64
 3   TravelAlone  891 non-null    int64  
 4   Pclass_1     891 non-null    bool   
 5   Pclass_2     891 non-null    bool   
 6   Pclass_3     891 non-null    bool   
 7   Embarked_C   891 non-null    bool   
 8   Embarked_Q   891 non-null    bool   
 9   Embarked_S   891 non-null    bool   
 10  Sex_male     891 non-null    bool   
dtypes: bool(7), float64(2), int64(2)
memory usage: 34.1 KB</code></pre>
</div>
</div>
<div id="dc29982e" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.kdeplot(final_train[<span class="st">'Age'</span>][final_train.Survived <span class="op">==</span> <span class="dv">1</span>], shade<span class="op">=</span><span class="va">True</span>, color <span class="op">=</span> <span class="st">'darkturquoise'</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(final_train[<span class="st">'Age'</span>][final_train.Survived <span class="op">==</span> <span class="dv">0</span>], shade<span class="op">=</span><span class="va">True</span>, color <span class="op">=</span> <span class="st">'lightcoral'</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">'Survived'</span>, <span class="st">'Died'</span>]) <span class="co"># or you can use plt.legend(['Survived', 'Died])</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Density Plot for Surviving Population and Deceased Population'</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Age'</span>) <span class="co"># or you can use ax.set(xlabel = 'Age')</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">10</span>,<span class="dv">85</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-36-output-1.png" width="1196" height="677" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The age distribution for survivors and deceased is actually very similar. One notable difference is that, of the survivors, a larger proportion were children. The passengers evidently made an attempt to save children by giving them a place on the life rafts.</p>
<div id="84f9aca6" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>avg_age <span class="op">=</span> final_train.groupby([<span class="st">'Survived'</span>]) [<span class="st">'Age'</span>].mean()</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>avg_age.to_frame().reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>30.028233</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>28.291433</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1d67ebc7" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data <span class="op">=</span> final_train, x  <span class="op">=</span> <span class="st">'Survived'</span>, y <span class="op">=</span> <span class="st">'Age'</span>, palette<span class="op">=</span><span class="st">'Set2'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Comparison of Age of Passengers Conditioned on Survived"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-38-output-1.png" width="589" height="455" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="8a6b6bc5" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Dummy Variable IsMinor</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>final_train[<span class="st">'IsMinor'</span>] <span class="op">=</span> np.where(final_train[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>final_test[<span class="st">'IsMinor'</span>] <span class="op">=</span> np.where(final_test[<span class="st">'Age'</span>] <span class="op">&lt;=</span> <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploration-of-fare-variable" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="exploration-of-fare-variable"><span class="header-section-number">6.2</span> Exploration of <code>Fare</code> Variable</h3>
<div id="5e4a50d1" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>train_df.groupby([<span class="st">'Survived'</span>]) [<span class="st">'Fare'</span>].mean().to_frame().reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Fare</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>22.117887</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>48.395408</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a13e61f4" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data <span class="op">=</span> final_train, x <span class="op">=</span> <span class="st">'Survived'</span>, y <span class="op">=</span> <span class="st">'Fare'</span>, palette<span class="op">=</span><span class="st">'Set2'</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparison of Fare of Passengers Conditioned on Survived'</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-41-output-1.png" width="597" height="455" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="18caf732" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.kdeplot(final_train[<span class="st">'Fare'</span>][final_train.Survived <span class="op">==</span> <span class="dv">1</span>],shade<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'darkturquoise'</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(final_train[<span class="st">'Fare'</span>][final_train.Survived<span class="op">==</span><span class="dv">0</span>], shade<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'lightcoral'</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">'Survived'</span>, <span class="st">'Died'</span>])</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span> <span class="st">'Fare'</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">20</span>,<span class="dv">200</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Density Plot of Fare for Surviving Population and Deceased Population'</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-42-output-1.png" width="1217" height="677" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As the distributions are clearly different for the fares of survivors vs.&nbsp;deceased, it’s likely that this would be a significant predictor in our final model. Passengers who paid lower fare appear to have been less likely to survive. This is probably strongly correlated with Passenger Class, which we’ll look at next.</p>
<div id="5948111e" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pair Plot of two continuous variables (Age and Fare)</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>sns.pairplot(data<span class="op">=</span>train_data, hue<span class="op">=</span><span class="st">'Survived'</span>, <span class="bu">vars</span><span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'Fare'</span>])</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1440x768 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-43-output-2.png" width="552" height="473" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exploration-of-pclass-variable" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="exploration-of-pclass-variable"><span class="header-section-number">6.3</span> Exploration of <code>PClass</code> Variable</h3>
<div id="c8f3f940" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>sns.barplot(data <span class="op">=</span> train_df, x <span class="op">=</span> <span class="st">'Pclass'</span>, y <span class="op">=</span> <span class="st">'Survived'</span>, color<span class="op">=</span><span class="st">'darkturquoise'</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-44-output-1.png" width="593" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As expected, first class passengers were more likely to survive.</p>
</section>
<section id="exploration-of-embarked-variable" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="exploration-of-embarked-variable"><span class="header-section-number">6.4</span> Exploration of <code>Embarked</code> Variable</h3>
<div id="71c54236" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>sns.barplot(x <span class="op">=</span> <span class="st">'Embarked'</span>, y <span class="op">=</span> <span class="st">'Survived'</span>, data<span class="op">=</span>train_df, color<span class="op">=</span><span class="st">"teal"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-45-output-1.png" width="593" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Passengers who boarded in Cherbourg, France, appear to have the highest survival rate. Passengers who boarded in Southhampton were marginally less likely to survive than those who boarded in Queenstown. This is probably related to passenger class, or maybe even the order of room assignments (e.g.&nbsp;maybe earlier passengers were more likely to have rooms closer to deck). It’s also worth noting the size of the whiskers in these plots. Because the number of passengers who boarded at Southhampton was highest, the confidence around the survival rate is the highest. The whisker of the Queenstown plot includes the Southhampton average, as well as the lower bound of its whisker. It’s possible that Queenstown passengers were equally, or even more, ill-fated than their Southhampton counterparts.</p>
</section>
<section id="exploration-of-travelalone-variable" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="exploration-of-travelalone-variable"><span class="header-section-number">6.5</span> Exploration of <code>TravelAlone</code> Variable</h3>
<div id="6294ac5a" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>sns.barplot(x <span class="op">=</span> <span class="st">'TravelAlone'</span>, y <span class="op">=</span> <span class="st">'Survived'</span>, data<span class="op">=</span>final_train, color<span class="op">=</span><span class="st">"mediumturquoise"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Travel Alone'</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-46-output-1.png" width="593" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Individuals traveling without family were more likely to die in the disaster than those with family aboard. Given the era, it’s likely that individuals traveling alone were likely male.</p>
</section>
<section id="exploration-of-gender-variable" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="exploration-of-gender-variable"><span class="header-section-number">6.6</span> Exploration of <code>Gender</code> Variable</h3>
<div id="e05d2099" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sns.barplot(x <span class="op">=</span> <span class="st">'Sex'</span>, y <span class="op">=</span> <span class="st">'Survived'</span>, data<span class="op">=</span>train_df, color<span class="op">=</span><span class="st">"aquamarine"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-47-output-1.png" width="593" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="chi-square-test-of-independence" class="level3" data-number="6.7">
<h3 data-number="6.7" class="anchored" data-anchor-id="chi-square-test-of-independence"><span class="header-section-number">6.7</span> Chi-square Test of Independence</h3>
<section id="chi-square-test-of-independence-betweeen-survived-and-sex" class="level4" data-number="6.7.1">
<h4 data-number="6.7.1" class="anchored" data-anchor-id="chi-square-test-of-independence-betweeen-survived-and-sex"><span class="header-section-number">6.7.1</span> Chi-square Test of Independence betweeen <code>Survived</code> and <code>Sex</code></h4>
<div id="c77c8508" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pd.crosstab(train_df[<span class="st">'Survived'</span>], train_df[<span class="st">'Sex'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">female</th>
<th data-quarto-table-cell-role="th">male</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>81</td>
<td>468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>233</td>
<td>109</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="de63240e" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing scipy package </span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fa024af8" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>stats.chi2_contingency(pd.crosstab(train_df[<span class="st">'Survived'</span>], train_df[<span class="st">'Sex'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>Chi2ContingencyResult(statistic=np.float64(260.71702016732104), pvalue=np.float64(1.1973570627755645e-58), dof=1, expected_freq=array([[193.47474747, 355.52525253],
       [120.52525253, 221.47474747]]))</code></pre>
</div>
</div>
<div id="faa2ea93" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>chi2_stat, p, dof, expected <span class="op">=</span> stats.chi2_contingency(pd.crosstab(train_df[<span class="st">'Survived'</span>], train_df[<span class="st">'Sex'</span>]))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"chi2 statistic:     </span><span class="sc">{</span>chi2_stat<span class="sc">:.5g}</span><span class="ss">"</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:            </span><span class="sc">{</span>p<span class="sc">:.5g}</span><span class="ss">"</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"degrees of freedom: </span><span class="sc">{</span>dof<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"expected frequencies:</span><span class="ch">\n</span><span class="st">"</span>,expected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>chi2 statistic:     260.72
p-value:            1.1974e-58
degrees of freedom: 1
expected frequencies:
 [[193.47474747 355.52525253]
 [120.52525253 221.47474747]]</code></pre>
</div>
</div>
</section>
<section id="chi-square-test-of-independence-betweeen-survived-and-pclass" class="level4" data-number="6.7.2">
<h4 data-number="6.7.2" class="anchored" data-anchor-id="chi-square-test-of-independence-betweeen-survived-and-pclass"><span class="header-section-number">6.7.2</span> Chi-square Test of Independence betweeen <code>Survived</code> and <code>Pclass</code></h4>
<div id="8b8e860a" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>chi2_stat_2, p_2, dof_2, expected_2 <span class="op">=</span> stats.chi2_contingency(pd.crosstab(train_df[<span class="st">'Survived'</span>], train_df[<span class="st">'Pclass'</span>]))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"chi2 statistic:     </span><span class="sc">{</span>chi2_stat_2<span class="sc">:.5g}</span><span class="ss">"</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:            </span><span class="sc">{</span>p_2<span class="sc">:.5g}</span><span class="ss">"</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"degrees of freedom: </span><span class="sc">{</span>dof_2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"expected frequencies:</span><span class="ch">\n</span><span class="st">"</span>,expected_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>chi2 statistic:     102.89
p-value:            4.5493e-23
degrees of freedom: 2
expected frequencies:
 [[133.09090909 113.37373737 302.53535354]
 [ 82.90909091  70.62626263 188.46464646]]</code></pre>
</div>
</div>
</section>
</section>
<section id="post-hoc-analysis-of-pclass" class="level3" data-number="6.8">
<h3 data-number="6.8" class="anchored" data-anchor-id="post-hoc-analysis-of-pclass"><span class="header-section-number">6.8</span> Post Hoc Analysis of <code>Pclass</code></h3>
<p>The explanation of <code>Post Hoc</code> analysis is given in this <a href="!https://www.youtube.com/watch?v=-S8EJEYNFIc">link</a>.</p>
<div id="806ea089" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>pclass_cross <span class="op">=</span> pd.crosstab(train_df[<span class="st">'Survived'</span>], train_df[<span class="st">'Pclass'</span>])</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>pclass_cross</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>80</td>
<td>97</td>
<td>372</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>136</td>
<td>87</td>
<td>119</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="9cec480a" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gc</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> combinations</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multicomp <span class="im">as</span> multi</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.multitest <span class="im">import</span> multipletests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="76f6813b" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>p_vals_chi <span class="op">=</span> []</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>pairs_of_class <span class="op">=</span> <span class="bu">list</span>(combinations(train_df[<span class="st">'Pclass'</span>].unique(),<span class="dv">2</span>))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each_pair <span class="kw">in</span> pairs_of_class:</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    each_df <span class="op">=</span> train_df[(train_df[<span class="st">'Pclass'</span>]<span class="op">==</span>each_pair[<span class="dv">0</span>]) <span class="op">|</span> (train_df[<span class="st">'Pclass'</span>]<span class="op">==</span>each_pair[<span class="dv">1</span>])]</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    p_vals_chi.append(<span class="op">\</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>          scipy.stats.chi2_contingency(</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>            pd.crosstab(each_df[<span class="st">'Survived'</span>], each_df[<span class="st">'Pclass'</span>]))[<span class="dv">1</span>]</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="96246508" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Results of Bonferroni Adjustment</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>bonferroni_results <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">'pair of class'</span>,<span class="op">\</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'original p value'</span>,<span class="op">\</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'corrected p value'</span>,<span class="op">\</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'Reject Null?'</span>])</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'pair of class'</span>] <span class="op">=</span> pairs_of_class</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'original p value'</span>] <span class="op">=</span> p_vals_chi</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Perform Bonferroni on the p-values and get the reject/fail to reject Null Hypothesis result.</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>multi_test_results_bonferroni <span class="op">=</span> multipletests(p_vals_chi, method<span class="op">=</span><span class="st">'bonferroni'</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'corrected p value'</span>] <span class="op">=</span> multi_test_results_bonferroni[<span class="dv">1</span>]</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'Reject Null?'</span>] <span class="op">=</span> multi_test_results_bonferroni[<span class="dv">0</span>]</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>bonferroni_results.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pair of class</th>
<th data-quarto-table-cell-role="th">original p value</th>
<th data-quarto-table-cell-role="th">corrected p value</th>
<th data-quarto-table-cell-role="th">Reject Null?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>(3, 1)</td>
<td>1.212338e-22</td>
<td>3.637013e-22</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>(3, 2)</td>
<td>1.224965e-08</td>
<td>3.674894e-08</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>(1, 2)</td>
<td>2.319805e-03</td>
<td>6.959414e-03</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="post-hoc-analysis-of-embarked" class="level3" data-number="6.9">
<h3 data-number="6.9" class="anchored" data-anchor-id="post-hoc-analysis-of-embarked"><span class="header-section-number">6.9</span> Post Hoc Analysis of <code>Embarked</code></h3>
<div id="29297420" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write code Here </span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>p_vals_chi_embark <span class="op">=</span> []</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>pairs_of_embark <span class="op">=</span> <span class="bu">list</span>(combinations(train_data[<span class="st">'Embarked'</span>].unique(),<span class="dv">2</span>))</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each_pair <span class="kw">in</span> pairs_of_embark:</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    each_df <span class="op">=</span> train_data[(train_data[<span class="st">'Embarked'</span>]<span class="op">==</span>each_pair[<span class="dv">0</span>]) <span class="op">|</span> (train_data[<span class="st">'Embarked'</span>]<span class="op">==</span>each_pair[<span class="dv">1</span>])]</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    p_vals_chi_embark.append(<span class="op">\</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>          scipy.stats.chi2_contingency(</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>            pd.crosstab(each_df[<span class="st">'Survived'</span>], each_df[<span class="st">'Embarked'</span>]))[<span class="dv">1</span>]</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="71eafcba" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Write code Here</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Results of Bonferroni Adjustment</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>bonferroni_results <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">'pair of embark'</span>,<span class="op">\</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'original p value'</span>,<span class="op">\</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'corrected p value'</span>,<span class="op">\</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'Reject Null?'</span>])</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'pair of embark'</span>] <span class="op">=</span> pairs_of_embark</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'original p value'</span>] <span class="op">=</span> p_vals_chi_embark</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Perform Bonferroni on the p-values and get the reject/fail to reject Null Hypothesis result.</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>multi_test_results_bonferroni_embark <span class="op">=</span> multipletests(p_vals_chi_embark, method<span class="op">=</span><span class="st">'bonferroni'</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'corrected p value'</span>] <span class="op">=</span> multi_test_results_bonferroni_embark[<span class="dv">1</span>]</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>bonferroni_results[<span class="st">'Reject Null?'</span>] <span class="op">=</span> multi_test_results_bonferroni_embark[<span class="dv">0</span>]</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>bonferroni_results.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pair of embark</th>
<th data-quarto-table-cell-role="th">original p value</th>
<th data-quarto-table-cell-role="th">corrected p value</th>
<th data-quarto-table-cell-role="th">Reject Null?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>(S, C)</td>
<td>5.537903e-07</td>
<td>0.000002</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>(S, Q)</td>
<td>4.493936e-01</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>(C, Q)</td>
<td>2.475540e-02</td>
<td>0.074266</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="logistic-regression-results" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="logistic-regression-results"><span class="header-section-number">7</span> Logistic Regression &amp; Results</h2>
<section id="feature-selection" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="feature-selection"><span class="header-section-number">7.1</span> Feature Selection</h3>
<section id="recursive-feature-selection-rfe" class="level4" data-number="7.1.1">
<h4 data-number="7.1.1" class="anchored" data-anchor-id="recursive-feature-selection-rfe"><span class="header-section-number">7.1.1</span> Recursive Feature Selection (RFE)</h4>
<p>Given an external estimator that assigns weights to features, recursive feature elimination (RFE) is to select features by recursively considering smaller and smaller sets of features. First, the estimator is trained on the initial set of features and the importance of each feature is obtained either through a <code>coef_ attribute</code> or through a <code>feature_importances_</code> attribute. Then, the least important features are pruned from current set of features.That procedure is recursively repeated on the pruned set until the desired number of features to select is eventually reached.</p>
<div id="cc75fb75" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our all training dataset </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>train_df</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="co"># impute missing values </span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>training <span class="co"># create the dummies </span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>final_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">TravelAlone</th>
<th data-quarto-table-cell-role="th">Pclass_1</th>
<th data-quarto-table-cell-role="th">Pclass_2</th>
<th data-quarto-table-cell-role="th">Pclass_3</th>
<th data-quarto-table-cell-role="th">Embarked_C</th>
<th data-quarto-table-cell-role="th">Embarked_Q</th>
<th data-quarto-table-cell-role="th">Embarked_S</th>
<th data-quarto-table-cell-role="th">Sex_male</th>
<th data-quarto-table-cell-role="th">IsMinor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>22.0</td>
<td>7.2500</td>
<td>0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>38.0</td>
<td>71.2833</td>
<td>0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>26.0</td>
<td>7.9250</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>35.0</td>
<td>53.1000</td>
<td>0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>35.0</td>
<td>8.0500</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">886</td>
<td>0</td>
<td>27.0</td>
<td>13.0000</td>
<td>1</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">887</td>
<td>1</td>
<td>19.0</td>
<td>30.0000</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">888</td>
<td>0</td>
<td>28.0</td>
<td>23.4500</td>
<td>0</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">889</td>
<td>1</td>
<td>26.0</td>
<td>30.0000</td>
<td>1</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">890</td>
<td>0</td>
<td>32.0</td>
<td>7.7500</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>891 rows × 12 columns</p>
</div>
</div>
</div>
<div id="ab6baae1" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'Fare'</span>, <span class="st">'TravelAlone'</span>,<span class="st">'Pclass_1'</span>,<span class="st">'Pclass_2'</span>,<span class="st">'Embarked_C'</span>,<span class="st">'Embarked_Q'</span>,<span class="st">'Sex_male'</span>,<span class="st">'IsMinor'</span>]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_train[cols] <span class="co"># features vector</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> final_train[<span class="st">'Survived'</span>] <span class="co"># Target vector </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="94f1d519" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFE</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFECV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6bc07331" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the model </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression()</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the RFE model </span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>rfe <span class="op">=</span> RFE(estimator<span class="op">=</span>model, n_features_to_select<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>rfe <span class="op">=</span> rfe.fit(X ,y)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="bu">dir</span>(rfe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>['__abstractmethods__',
 '__annotations__',
 '__class__',
 '__delattr__',
 '__dict__',
 '__dir__',
 '__doc__',
 '__eq__',
 '__firstlineno__',
 '__format__',
 '__ge__',
 '__getattribute__',
 '__getstate__',
 '__gt__',
 '__hash__',
 '__init__',
 '__init_subclass__',
 '__le__',
 '__lt__',
 '__module__',
 '__ne__',
 '__new__',
 '__reduce__',
 '__reduce_ex__',
 '__repr__',
 '__setattr__',
 '__setstate__',
 '__sizeof__',
 '__sklearn_clone__',
 '__sklearn_tags__',
 '__static_attributes__',
 '__str__',
 '__subclasshook__',
 '__weakref__',
 '_abc_impl',
 '_build_request_for_signature',
 '_check_feature_names',
 '_check_n_features',
 '_doc_link_module',
 '_doc_link_template',
 '_doc_link_url_param_generator',
 '_estimator_type',
 '_fit',
 '_get_default_requests',
 '_get_doc_link',
 '_get_metadata_request',
 '_get_param_names',
 '_get_support_mask',
 '_get_tags',
 '_more_tags',
 '_parameter_constraints',
 '_repr_html_',
 '_repr_html_inner',
 '_repr_mimebundle_',
 '_sklearn_auto_wrap_output_keys',
 '_transform',
 '_validate_data',
 '_validate_params',
 'classes_',
 'decision_function',
 'estimator',
 'estimator_',
 'feature_names_in_',
 'fit',
 'fit_transform',
 'get_feature_names_out',
 'get_metadata_routing',
 'get_params',
 'get_support',
 'importance_getter',
 'inverse_transform',
 'n_features_',
 'n_features_in_',
 'n_features_to_select',
 'predict',
 'predict_log_proba',
 'predict_proba',
 'ranking_',
 'score',
 'set_output',
 'set_params',
 'step',
 'support_',
 'transform',
 'verbose']</code></pre>
</div>
</div>
<div id="0d7a3a64" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the selection of the attributes</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Selected features: </span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> <span class="bu">list</span>(X.columns[rfe.support_]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Selected features: ['Age', 'TravelAlone', 'Pclass_1', 'Pclass_2', 'Embarked_C', 'Embarked_Q', 'Sex_male', 'IsMinor']</code></pre>
</div>
</div>
<div id="13274f01" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the Regression Results </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y,X.astype(<span class="bu">float</span>))</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> logit_model.fit()</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result.summary2())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.448075
         Iterations 6
                         Results: Logit
=================================================================
Model:              Logit            Method:           MLE       
Dependent Variable: Survived         Pseudo R-squared: 0.327     
Date:               2025-02-12 21:28 AIC:              816.4704  
No. Observations:   891              BIC:              859.6015  
Df Model:           8                Log-Likelihood:   -399.24   
Df Residuals:       882              LL-Null:          -593.33   
Converged:          1.0000           LLR p-value:      6.3002e-79
No. Iterations:     6.0000           Scale:            1.0000    
------------------------------------------------------------------
              Coef.   Std.Err.     z      P&gt;|z|    [0.025   0.975]
------------------------------------------------------------------
Age          -0.0121    0.0057   -2.1381  0.0325  -0.0232  -0.0010
Fare          0.0015    0.0022    0.6878  0.4916  -0.0028   0.0058
TravelAlone   0.2803    0.1936    1.4475  0.1477  -0.0992   0.6597
Pclass_1      2.1646    0.2838    7.6272  0.0000   1.6083   2.7208
Pclass_2      1.3948    0.2309    6.0399  0.0000   0.9422   1.8473
Embarked_C    0.6014    0.2332    2.5790  0.0099   0.1443   1.0584
Embarked_Q    0.6366    0.3139    2.0282  0.0425   0.0214   1.2517
Sex_male     -2.5527    0.1955  -13.0567  0.0000  -2.9359  -2.1695
IsMinor       0.9987    0.2737    3.6488  0.0003   0.4623   1.5352
=================================================================
</code></pre>
</div>
</div>
<div id="3c53beb1" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>cols2 <span class="op">=</span> [<span class="st">'Age'</span>,  <span class="st">'TravelAlone'</span>,<span class="st">'Pclass_1'</span>,<span class="st">'Pclass_2'</span>,<span class="st">'Embarked_C'</span>,<span class="st">'Embarked_Q'</span>,<span class="st">'Sex_male'</span>,<span class="st">'IsMinor'</span>]</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>X_alt <span class="op">=</span> final_train[cols2] <span class="co"># features vector</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>logit_model2 <span class="op">=</span> sm.Logit(y,sm.add_constant(X_alt.astype(<span class="bu">float</span>)))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>result2 <span class="op">=</span> logit_model2.fit()</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result2.summary2())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.446363
         Iterations 6
                         Results: Logit
=================================================================
Model:              Logit            Method:           MLE       
Dependent Variable: Survived         Pseudo R-squared: 0.330     
Date:               2025-02-12 21:28 AIC:              813.4192  
No. Observations:   891              BIC:              856.5503  
Df Model:           8                Log-Likelihood:   -397.71   
Df Residuals:       882              LL-Null:          -593.33   
Converged:          1.0000           LLR p-value:      1.4027e-79
No. Iterations:     6.0000           Scale:            1.0000    
------------------------------------------------------------------
              Coef.   Std.Err.     z      P&gt;|z|    [0.025   0.975]
------------------------------------------------------------------
const         0.6181    0.3319    1.8623  0.0626  -0.0324   1.2686
Age          -0.0245    0.0091   -2.7055  0.0068  -0.0423  -0.0068
TravelAlone   0.1475    0.1973    0.7476  0.4547  -0.2392   0.5343
Pclass_1      2.2826    0.2546    8.9666  0.0000   1.7837   2.7815
Pclass_2      1.3380    0.2340    5.7178  0.0000   0.8793   1.7966
Embarked_C    0.5518    0.2351    2.3471  0.0189   0.0910   1.0126
Embarked_Q    0.5323    0.3217    1.6548  0.0980  -0.0982   1.1627
Sex_male     -2.6141    0.1973  -13.2482  0.0000  -3.0009  -2.2274
IsMinor       0.5957    0.3560    1.6735  0.0942  -0.1020   1.2935
=================================================================
</code></pre>
</div>
</div>
<div id="68a92afe" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> stargazer.stargazer <span class="im">import</span> Stargazer</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>titanic_logit <span class="op">=</span> Stargazer([result, result2])</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>titanic_logit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<table style="text-align:center"><tbody><tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="2"><em>Dependent variable: Survived</em></td></tr><tr><td style="text-align:left"></td></tr><tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td></tr>
<tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr>

<tr><td style="text-align:left">Age</td><td>-0.012<sup>**</sup></td><td>-0.025<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.006)</td><td>(0.009)</td></tr>
<tr><td style="text-align:left">Embarked_C</td><td>0.601<sup>***</sup></td><td>0.552<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.233)</td><td>(0.235)</td></tr>
<tr><td style="text-align:left">Embarked_Q</td><td>0.637<sup>**</sup></td><td>0.532<sup>*</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.314)</td><td>(0.322)</td></tr>
<tr><td style="text-align:left">Fare</td><td>0.002<sup></sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td>(0.002)</td><td></td></tr>
<tr><td style="text-align:left">IsMinor</td><td>0.999<sup>***</sup></td><td>0.596<sup>*</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.274)</td><td>(0.356)</td></tr>
<tr><td style="text-align:left">Pclass_1</td><td>2.165<sup>***</sup></td><td>2.283<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.284)</td><td>(0.255)</td></tr>
<tr><td style="text-align:left">Pclass_2</td><td>1.395<sup>***</sup></td><td>1.338<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.231)</td><td>(0.234)</td></tr>
<tr><td style="text-align:left">Sex_male</td><td>-2.553<sup>***</sup></td><td>-2.614<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.196)</td><td>(0.197)</td></tr>
<tr><td style="text-align:left">TravelAlone</td><td>0.280<sup></sup></td><td>0.148<sup></sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.194)</td><td>(0.197)</td></tr>
<tr><td style="text-align:left">const</td><td></td><td>0.618<sup>*</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.332)</td></tr>

<tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align: left">Observations</td><td>891</td><td>891</td></tr><tr><td style="text-align: left">Pseudo R<sup>2</sup></td><td>0.327</td><td>0.330</td></tr>
<tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align: left">Note:</td><td colspan="2" style="text-align: right"><sup>*</sup>p&lt;0.1; <sup>**</sup>p&lt;0.05; <sup>***</sup>p&lt;0.01</td></tr></tbody></table>
</div>
</div>
<div id="ab1a7ec6" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpreting the coefficients, which are the log odds; therefore, we need to convert them into odds ratio. </span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>np.exp(<span class="op">-</span><span class="fl">2.5527</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>np.float64(0.0778711298546485)</code></pre>
</div>
</div>
<div id="dc259768" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>np.exp(result.params) <span class="co"># Getting the Odds Ratio of all Features </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>Age            0.987957
Fare           1.001519
TravelAlone    1.323475
Pclass_1       8.710827
Pclass_2       4.033966
Embarked_C     1.824624
Embarked_Q     1.889992
Sex_male       0.077872
IsMinor        2.714860
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="feature-ranking-with-recursive-feature-elimination-and-cross-validation-rfecv" class="level4" data-number="7.1.2">
<h4 data-number="7.1.2" class="anchored" data-anchor-id="feature-ranking-with-recursive-feature-elimination-and-cross-validation-rfecv"><span class="header-section-number">7.1.2</span> Feature Ranking with Recursive Feature Elimination and Cross-validation (<code>RFECV</code>)</h4>
<p><code>RFECV</code> performs <code>RFE</code> in a cross-validation loop to find the optimal number or the best number of features. Hereafter a recursive feature elimination applied on logistic regression with automatic tuning of the number of features selected with cross-validation</p>
<div id="3b25c936" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the RFE object and compute a cross-validated score.</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The "accuracy" scoring is proportional to the number of correct classifications</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>rfecv <span class="op">=</span> RFECV(estimator<span class="op">=</span>LogisticRegression(max_iter <span class="op">=</span> <span class="dv">5000</span>), step<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">10</span>, scoring<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>rfecv.fit(X, y)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">dir</span>(rfecv):</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_RFECV__metadata_request__fit
__abstractmethods__
__annotations__
__class__
__delattr__
__dict__
__dir__
__doc__
__eq__
__firstlineno__
__format__
__ge__
__getattribute__
__getstate__
__gt__
__hash__
__init__
__init_subclass__
__le__
__lt__
__module__
__ne__
__new__
__reduce__
__reduce_ex__
__repr__
__setattr__
__setstate__
__sizeof__
__sklearn_clone__
__sklearn_tags__
__static_attributes__
__str__
__subclasshook__
__weakref__
_abc_impl
_build_request_for_signature
_check_feature_names
_check_n_features
_doc_link_module
_doc_link_template
_doc_link_url_param_generator
_estimator_type
_fit
_get_default_requests
_get_doc_link
_get_metadata_request
_get_param_names
_get_scorer
_get_support_mask
_get_tags
_more_tags
_parameter_constraints
_repr_html_
_repr_html_inner
_repr_mimebundle_
_sklearn_auto_wrap_output_keys
_transform
_validate_data
_validate_params
classes_
cv
cv_results_
decision_function
estimator
estimator_
feature_names_in_
fit
fit_transform
get_feature_names_out
get_metadata_routing
get_params
get_support
importance_getter
inverse_transform
min_features_to_select
n_features_
n_features_in_
n_jobs
predict
predict_log_proba
predict_proba
ranking_
score
scoring
set_output
set_params
step
support_
transform
verbose</code></pre>
</div>
</div>
<div id="29ad16c6" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To get the accuracy</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>rfecv.cv_results_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>{'mean_test_score': array([0.78672909, 0.78672909, 0.78672909, 0.79009988, 0.78560549,
        0.78561798, 0.78790262, 0.79574282, 0.79463171]),
 'std_test_score': array([0.02859935, 0.02859935, 0.02859935, 0.02989151, 0.02604354,
        0.02546772, 0.03370206, 0.02689652, 0.02691683]),
 'split0_test_score': array([0.81111111, 0.81111111, 0.81111111, 0.81111111, 0.81111111,
        0.8       , 0.76666667, 0.78888889, 0.77777778]),
 'split1_test_score': array([0.79775281, 0.79775281, 0.79775281, 0.79775281, 0.76404494,
        0.75280899, 0.76404494, 0.79775281, 0.79775281]),
 'split2_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.76404494, 0.76404494,
        0.78651685, 0.7752809 , 0.7752809 , 0.7752809 ]),
 'split3_test_score': array([0.84269663, 0.84269663, 0.84269663, 0.85393258, 0.83146067,
        0.83146067, 0.84269663, 0.85393258, 0.85393258]),
 'split4_test_score': array([0.79775281, 0.79775281, 0.79775281, 0.79775281, 0.79775281,
        0.79775281, 0.79775281, 0.7752809 , 0.7752809 ]),
 'split5_test_score': array([0.7752809 , 0.7752809 , 0.7752809 , 0.78651685, 0.78651685,
        0.78651685, 0.78651685, 0.78651685, 0.7752809 ]),
 'split6_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.76404494, 0.76404494,
        0.76404494, 0.76404494, 0.76404494, 0.7752809 ]),
 'split7_test_score': array([0.74157303, 0.74157303, 0.74157303, 0.74157303, 0.74157303,
        0.74157303, 0.74157303, 0.7752809 , 0.7752809 ]),
 'split8_test_score': array([0.80898876, 0.80898876, 0.80898876, 0.80898876, 0.80898876,
        0.80898876, 0.85393258, 0.83146067, 0.83146067]),
 'split9_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.7752809 , 0.78651685,
        0.78651685, 0.78651685, 0.80898876, 0.80898876]),
 'n_features': array([1, 2, 3, 4, 5, 6, 7, 8, 9])}</code></pre>
</div>
</div>
<div id="f5b33d22" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(rfecv.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>dict</code></pre>
</div>
</div>
<div id="ff2d86e0" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>rfecv.cv_results_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>{'mean_test_score': array([0.78672909, 0.78672909, 0.78672909, 0.79009988, 0.78560549,
        0.78561798, 0.78790262, 0.79574282, 0.79463171]),
 'std_test_score': array([0.02859935, 0.02859935, 0.02859935, 0.02989151, 0.02604354,
        0.02546772, 0.03370206, 0.02689652, 0.02691683]),
 'split0_test_score': array([0.81111111, 0.81111111, 0.81111111, 0.81111111, 0.81111111,
        0.8       , 0.76666667, 0.78888889, 0.77777778]),
 'split1_test_score': array([0.79775281, 0.79775281, 0.79775281, 0.79775281, 0.76404494,
        0.75280899, 0.76404494, 0.79775281, 0.79775281]),
 'split2_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.76404494, 0.76404494,
        0.78651685, 0.7752809 , 0.7752809 , 0.7752809 ]),
 'split3_test_score': array([0.84269663, 0.84269663, 0.84269663, 0.85393258, 0.83146067,
        0.83146067, 0.84269663, 0.85393258, 0.85393258]),
 'split4_test_score': array([0.79775281, 0.79775281, 0.79775281, 0.79775281, 0.79775281,
        0.79775281, 0.79775281, 0.7752809 , 0.7752809 ]),
 'split5_test_score': array([0.7752809 , 0.7752809 , 0.7752809 , 0.78651685, 0.78651685,
        0.78651685, 0.78651685, 0.78651685, 0.7752809 ]),
 'split6_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.76404494, 0.76404494,
        0.76404494, 0.76404494, 0.76404494, 0.7752809 ]),
 'split7_test_score': array([0.74157303, 0.74157303, 0.74157303, 0.74157303, 0.74157303,
        0.74157303, 0.74157303, 0.7752809 , 0.7752809 ]),
 'split8_test_score': array([0.80898876, 0.80898876, 0.80898876, 0.80898876, 0.80898876,
        0.80898876, 0.85393258, 0.83146067, 0.83146067]),
 'split9_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.7752809 , 0.78651685,
        0.78651685, 0.78651685, 0.80898876, 0.80898876]),
 'n_features': array([1, 2, 3, 4, 5, 6, 7, 8, 9])}</code></pre>
</div>
</div>
<div id="ba1ce980" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>rfecv.n_features_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>np.int64(8)</code></pre>
</div>
</div>
<div id="9d0d3e61" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(X.columns[rfecv.support_])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>['Age',
 'TravelAlone',
 'Pclass_1',
 'Pclass_2',
 'Embarked_C',
 'Embarked_Q',
 'Sex_male',
 'IsMinor']</code></pre>
</div>
</div>
<div id="f025416a" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To check whether the RFE and RFECV generate the same features</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(<span class="bu">list</span>(X.columns[rfecv.support_])) <span class="op">==</span> <span class="bu">set</span>(<span class="bu">list</span>((X.columns[rfe.support_])))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>True</code></pre>
</div>
</div>
<div id="802c09ce" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>rfecv.cv_results_.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>dict_keys(['mean_test_score', 'std_test_score', 'split0_test_score', 'split1_test_score', 'split2_test_score', 'split3_test_score', 'split4_test_score', 'split5_test_score', 'split6_test_score', 'split7_test_score', 'split8_test_score', 'split9_test_score', 'n_features'])</code></pre>
</div>
</div>
<div id="b7edbc4e" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>crossVal_results <span class="op">=</span> rfecv.cv_results_</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>crossVal_results</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> crossVal_results[<span class="st">'mean_test_score'</span>]</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> crossVal_results[<span class="st">'std_test_score'</span>]</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>crossVal_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>{'split0_test_score': array([0.81111111, 0.81111111, 0.81111111, 0.81111111, 0.81111111,
        0.8       , 0.76666667, 0.78888889, 0.77777778]),
 'split1_test_score': array([0.79775281, 0.79775281, 0.79775281, 0.79775281, 0.76404494,
        0.75280899, 0.76404494, 0.79775281, 0.79775281]),
 'split2_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.76404494, 0.76404494,
        0.78651685, 0.7752809 , 0.7752809 , 0.7752809 ]),
 'split3_test_score': array([0.84269663, 0.84269663, 0.84269663, 0.85393258, 0.83146067,
        0.83146067, 0.84269663, 0.85393258, 0.85393258]),
 'split4_test_score': array([0.79775281, 0.79775281, 0.79775281, 0.79775281, 0.79775281,
        0.79775281, 0.79775281, 0.7752809 , 0.7752809 ]),
 'split5_test_score': array([0.7752809 , 0.7752809 , 0.7752809 , 0.78651685, 0.78651685,
        0.78651685, 0.78651685, 0.78651685, 0.7752809 ]),
 'split6_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.76404494, 0.76404494,
        0.76404494, 0.76404494, 0.76404494, 0.7752809 ]),
 'split7_test_score': array([0.74157303, 0.74157303, 0.74157303, 0.74157303, 0.74157303,
        0.74157303, 0.74157303, 0.7752809 , 0.7752809 ]),
 'split8_test_score': array([0.80898876, 0.80898876, 0.80898876, 0.80898876, 0.80898876,
        0.80898876, 0.85393258, 0.83146067, 0.83146067]),
 'split9_test_score': array([0.76404494, 0.76404494, 0.76404494, 0.7752809 , 0.78651685,
        0.78651685, 0.78651685, 0.80898876, 0.80898876]),
 'n_features': array([1, 2, 3, 4, 5, 6, 7, 8, 9])}</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="correlation-matrix" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="correlation-matrix"><span class="header-section-number">8</span> Correlation Matrix</h2>
<div id="78e2e72f" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>Selected_features <span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'TravelAlone'</span>, <span class="st">'Pclass_1'</span>, <span class="st">'Pclass_2'</span>, <span class="st">'Embarked_C'</span>, </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Embarked_S'</span>, <span class="st">'Sex_male'</span>, <span class="st">'IsMinor'</span>]</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_train[Selected_features] <span class="co"># Recreated features vector </span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(X.corr(), annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"RdYlGn"</span>) <span class="co"># for cmap = 'viridis' can also be used.</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-78-output-1.png" width="684" height="493" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f678e8c8" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(final_train[[<span class="st">'Survived'</span>, <span class="st">'Age'</span>, <span class="st">'TravelAlone'</span>, <span class="st">'Pclass_1'</span>, <span class="st">'Pclass_2'</span>, <span class="st">'Embarked_C'</span>, <span class="st">'Embarked_S'</span>, <span class="st">'Sex_male'</span>, <span class="st">'IsMinor'</span>]].corr(), annot <span class="op">=</span> <span class="va">True</span>, cmap <span class="op">=</span> <span class="st">'viridis'</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-79-output-1.png" width="684" height="493" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-evaluation-procedures" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="model-evaluation-procedures"><span class="header-section-number">9</span> Model Evaluation Procedures</h2>
<section id="model-evaluation-based-on-traintest-split" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="model-evaluation-based-on-traintest-split"><span class="header-section-number">9.1</span> Model Evaluation Based on Train/Test Split</h3>
<div id="14ec024b" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, cross_val_score</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_validate</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report, precision_score, recall_score</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, precision_recall_curve, roc_curve, auc, log_loss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7dad49db" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_train[Selected_features]</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> final_train[<span class="st">'Survived'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cd719ac3" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use train/test split with different random_state values</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we can change the random_state values that changes the accuracy scores</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the scores change a lot, this is why testing scores is a high-variance estimate</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bbf6380c" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check classification scores of Logistic Regression</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> LogisticRegression()</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>logreg.fit(X_train, y_train)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> logreg.predict(X_test) <span class="co"># Prediction actual class</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>y_pred_proba <span class="op">=</span> logreg.predict_proba(X_test) [:,<span class="dv">1</span>]</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>[fpr, tpr, thr] <span class="op">=</span> roc_curve(y_test, y_pred_proba)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train/Test split results:'</span>)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logreg.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" accuracy is </span><span class="sc">%2.3f</span><span class="st">"</span> <span class="op">%</span> accuracy_score(y_test, y_pred))</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logreg.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" log_loss is </span><span class="sc">%2.3f</span><span class="st">"</span> <span class="op">%</span> log_loss(y_test, y_pred_proba)) </span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logreg.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" auc is </span><span class="sc">%2.3f</span><span class="st">"</span> <span class="op">%</span> auc(fpr, tpr)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train/Test split results:
LogisticRegression accuracy is 0.810
LogisticRegression log_loss is 0.446
LogisticRegression auc is 0.847</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="confusion-matrix"><span class="header-section-number">9.2</span> Confusion Matrix</h3>
<div id="d7611193" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Confusion matrix</span><span class="ch">\n\n</span><span class="st">'</span>, cm)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">True Positives(TP) = '</span>, cm[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">True Negatives(TN) = '</span>, cm[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">False Positives(FP) = '</span>, cm[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">False Negatives(FN) = '</span>, cm[<span class="dv">1</span>,<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion matrix

 [[98 13]
 [21 47]]

True Positives(TP) =  98

True Negatives(TN) =  47

False Positives(FP) =  13

False Negatives(FN) =  21</code></pre>
</div>
</div>
<div id="d1a5fa5f" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing Confusion Matrix</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>cm_matrix <span class="op">=</span> pd.DataFrame(data<span class="op">=</span> cm, columns<span class="op">=</span>[<span class="st">'Actual Positive:1'</span>, <span class="st">'Actual Negative:0'</span>], </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>                                 index<span class="op">=</span>[<span class="st">'Predict Positive:1'</span>, <span class="st">'Predict Negative:0'</span>])</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_matrix, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'YlGnBu'</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-85-output-1.png" width="469" height="342" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="classification-report" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="classification-report"><span class="header-section-number">9.3</span> Classification Report</h3>
<div id="775ec85c" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.82      0.88      0.85       111
           1       0.78      0.69      0.73        68

    accuracy                           0.81       179
   macro avg       0.80      0.79      0.79       179
weighted avg       0.81      0.81      0.81       179
</code></pre>
</div>
</div>
</section>
<section id="roc-auc-curve" class="level3" data-number="9.4">
<h3 data-number="9.4" class="anchored" data-anchor-id="roc-auc-curve"><span class="header-section-number">9.4</span> ROC-AUC Curve</h3>
<div id="1e6f62be" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> np.<span class="bu">min</span>(np.where(tpr <span class="op">&gt;</span> <span class="fl">0.95</span>)) <span class="co"># index of the first threshold for which the sensibility (true positive rate (tpr)) &gt; 0.95</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, color<span class="op">=</span><span class="st">'coral'</span>, label<span class="op">=</span><span class="st">'ROC curve (area = </span><span class="sc">%0.3f</span><span class="st">)'</span> <span class="op">%</span> auc(fpr, tpr))</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,fpr[idx]], [tpr[idx],tpr[idx]], <span class="st">'k--'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>plt.plot([fpr[idx],fpr[idx]], [<span class="dv">0</span>,tpr[idx]], <span class="st">'k--'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="fl">0.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="fl">0.0</span>, <span class="fl">1.05</span>])</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False Positive Rate (1 - specificity)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Positive Rate (recall/sensitivity)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Receiver operating characteristic (ROC) curve'</span>)</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>)</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Using a threshold of </span><span class="sc">%.3f</span><span class="st"> "</span> <span class="op">%</span> thr[idx] <span class="op">+</span> <span class="st">"guarantees a sensitivity of </span><span class="sc">%.3f</span><span class="st"> "</span> <span class="op">%</span> tpr[idx] <span class="op">+</span>  </span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">"and a specificity of </span><span class="sc">%.3f</span><span class="st">"</span> <span class="op">%</span> (<span class="dv">1</span><span class="op">-</span>fpr[idx]) <span class="op">+</span> </span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">", i.e. a false positive rate of </span><span class="sc">%.2f%%</span><span class="st">."</span> <span class="op">%</span> (np.array(fpr[idx])<span class="op">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-87-output-1.png" width="606" height="457" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Using a threshold of 0.087 guarantees a sensitivity of 0.956 and a specificity of 0.225, i.e. a false positive rate of 77.48%.</code></pre>
</div>
</div>
</section>
</section>
<section id="model-evaluation-based-on-k-fold-cross-validation-cross_val_score-function" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="model-evaluation-based-on-k-fold-cross-validation-cross_val_score-function"><span class="header-section-number">10</span> Model Evaluation Based on K-fold Cross-validation <code>cross_val_score()</code> Function</h2>
<div id="7a55926a" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10-fold cross-validation logistic regression</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">5000</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use cross_val_score function</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We are passing the entirety of X and y, not X_train or y_train, it takes care of splitting the data</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cv=10 for 10 folds</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="co"># scoring = {'accuracy', 'neg_log_loss', 'roc_auc'} for evaluation metric - althought they are many</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>scores_accuracy <span class="op">=</span> cross_val_score(logreg, X, y, cv<span class="op">=</span><span class="dv">10</span>, scoring<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>scores_log_loss <span class="op">=</span> cross_val_score(logreg, X, y, cv<span class="op">=</span><span class="dv">10</span>, scoring<span class="op">=</span><span class="st">'neg_log_loss'</span>)</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>scores_auc <span class="op">=</span> cross_val_score(logreg, X, y, cv<span class="op">=</span><span class="dv">10</span>, scoring<span class="op">=</span><span class="st">'roc_auc'</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'K-fold cross-validation results:'</span>)</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logreg.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" average accuracy is </span><span class="sc">%2.3f</span><span class="st">"</span> <span class="op">%</span> scores_accuracy.mean())</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logreg.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" average log_loss is </span><span class="sc">%2.3f</span><span class="st">"</span> <span class="op">%</span> <span class="op">-</span>scores_log_loss.mean())</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logreg.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" average auc is </span><span class="sc">%2.3f</span><span class="st">"</span> <span class="op">%</span> scores_auc.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-fold cross-validation results:
LogisticRegression average accuracy is 0.796
LogisticRegression average log_loss is 0.454
LogisticRegression average auc is 0.850</code></pre>
</div>
</div>
<section id="model-evaluation-based-on-k-fold-cross-validation-using-cross_validate-function" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="model-evaluation-based-on-k-fold-cross-validation-using-cross_validate-function"><span class="header-section-number">10.1</span> Model Evaluation Based on K-fold Cross-validation Using <code>cross_validate()</code> Function</h3>
<div id="d19f92cc" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>scoring <span class="op">=</span> {<span class="st">'accuracy'</span>: <span class="st">'accuracy'</span>, <span class="st">'log_loss'</span>: <span class="st">'neg_log_loss'</span>, <span class="st">'auc'</span>: <span class="st">'roc_auc'</span>}</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>modelCV <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">5000</span>)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> cross_validate(modelCV, X, y, cv<span class="op">=</span><span class="dv">10</span>, scoring<span class="op">=</span><span class="bu">list</span>(scoring.values()), </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>                         return_train_score<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'K-fold cross-validation results:'</span>)</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> sc <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(scoring)):</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(modelCV.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" average </span><span class="sc">%s</span><span class="st">: </span><span class="sc">%.3f</span><span class="st"> (+/-</span><span class="sc">%.3f</span><span class="st">)"</span> <span class="op">%</span> (<span class="bu">list</span>(scoring.keys())[sc], <span class="op">-</span>results[<span class="st">'test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> <span class="bu">list</span>(scoring.values())[sc]].mean()</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">if</span> <span class="bu">list</span>(scoring.values())[sc]<span class="op">==</span><span class="st">'neg_log_loss'</span> </span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">else</span> results[<span class="st">'test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> <span class="bu">list</span>(scoring.values())[sc]].mean(), </span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>                               results[<span class="st">'test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> <span class="bu">list</span>(scoring.values())[sc]].std())) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-fold cross-validation results:
LogisticRegression average accuracy: 0.796 (+/-0.024)
LogisticRegression average log_loss: 0.454 (+/-0.037)
LogisticRegression average auc: 0.850 (+/-0.028)</code></pre>
</div>
</div>
<p>What happens when we add the feature <code>Fare</code> -</p>
<div id="8dff4a06" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">"Age"</span>,<span class="st">"Fare"</span>,<span class="st">"TravelAlone"</span>,<span class="st">"Pclass_1"</span>,<span class="st">"Pclass_2"</span>,<span class="st">"Embarked_C"</span>,<span class="st">"Embarked_S"</span>,<span class="st">"Sex_male"</span>,<span class="st">"IsMinor"</span>]</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_train[cols]</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>scoring <span class="op">=</span> {<span class="st">'accuracy'</span>: <span class="st">'accuracy'</span>, <span class="st">'log_loss'</span>: <span class="st">'neg_log_loss'</span>, <span class="st">'auc'</span>: <span class="st">'roc_auc'</span>}</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>modelCV <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">5000</span>)</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> cross_validate(modelCV, final_train[cols], y, cv<span class="op">=</span><span class="dv">10</span>, scoring<span class="op">=</span><span class="bu">list</span>(scoring.values()), </span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>                         return_train_score<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'K-fold cross-validation results:'</span>)</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> sc <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(scoring)):</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(modelCV.__class__.<span class="va">__name__</span><span class="op">+</span><span class="st">" average </span><span class="sc">%s</span><span class="st">: </span><span class="sc">%.3f</span><span class="st"> (+/-</span><span class="sc">%.3f</span><span class="st">)"</span> <span class="op">%</span> (<span class="bu">list</span>(scoring.keys())[sc], <span class="op">-</span>results[<span class="st">'test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> <span class="bu">list</span>(scoring.values())[sc]].mean()</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">if</span> <span class="bu">list</span>(scoring.values())[sc]<span class="op">==</span><span class="st">'neg_log_loss'</span> </span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">else</span> results[<span class="st">'test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> <span class="bu">list</span>(scoring.values())[sc]].mean(), </span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>                               results[<span class="st">'test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> <span class="bu">list</span>(scoring.values())[sc]].std()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-fold cross-validation results:
LogisticRegression average accuracy: 0.795 (+/-0.027)
LogisticRegression average log_loss: 0.455 (+/-0.037)
LogisticRegression average auc: 0.849 (+/-0.028)</code></pre>
</div>
</div>
<p>We notice that the model is slightly deteriorated. The <code>Fare</code> variable does not carry any useful information. Its presence is just a noise for the logistic regression model.</p>
</section>
</section>
<section id="gridsearchcv-evaluating-using-multiple-scorers-simultaneously" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="gridsearchcv-evaluating-using-multiple-scorers-simultaneously"><span class="header-section-number">11</span> <code>GridSearchCV</code> Evaluating Using Multiple Scorers Simultaneously</h2>
<div id="9b5e9eb0" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_train[Selected_features]</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: np.arange(<span class="fl">1e-05</span>, <span class="dv">3</span>, <span class="fl">0.1</span>)}</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>scoring <span class="op">=</span> {<span class="st">'Accuracy'</span>: <span class="st">'accuracy'</span>, <span class="st">'AUC'</span>: <span class="st">'roc_auc'</span>, <span class="st">'Log_loss'</span>: <span class="st">'neg_log_loss'</span>}</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> GridSearchCV(LogisticRegression(max_iter<span class="op">=</span><span class="dv">5000</span>), return_train_score<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>                  param_grid<span class="op">=</span>param_grid, scoring<span class="op">=</span>scoring, cv<span class="op">=</span><span class="dv">10</span>, refit<span class="op">=</span><span class="st">'Accuracy'</span>)</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>gs.fit(X, y)</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> gs.cv_results_</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'='</span><span class="op">*</span><span class="dv">20</span>)</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"best params: "</span> <span class="op">+</span> <span class="bu">str</span>(gs.best_estimator_))</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"best params: "</span> <span class="op">+</span> <span class="bu">str</span>(gs.best_params_))</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'best score:'</span>, gs.best_score_)</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'='</span><span class="op">*</span><span class="dv">20</span>)</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV evaluating using multiple scorers simultaneously"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Inverse of regularization strength: C"</span>)</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Score"</span>)</span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.axes()</span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, param_grid[<span class="st">'C'</span>].<span class="bu">max</span>()) </span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">0.35</span>, <span class="fl">0.95</span>)</span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the regular numpy array from the MaskedArray</span></span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>X_axis <span class="op">=</span> np.array(results[<span class="st">'param_C'</span>].data, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> scorer, color <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">list</span>(scoring.keys()), [<span class="st">'g'</span>, <span class="st">'k'</span>, <span class="st">'b'</span>]): </span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sample, style <span class="kw">in</span> ((<span class="st">'train'</span>, <span class="st">'--'</span>), (<span class="st">'test'</span>, <span class="st">'-'</span>)):</span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>        sample_score_mean <span class="op">=</span> <span class="op">-</span>results[<span class="st">'mean_</span><span class="sc">%s</span><span class="st">_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (sample, scorer)] <span class="cf">if</span> scoring[scorer]<span class="op">==</span><span class="st">'neg_log_loss'</span> <span class="cf">else</span> results[<span class="st">'mean_</span><span class="sc">%s</span><span class="st">_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (sample, scorer)]</span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>        sample_score_std <span class="op">=</span> results[<span class="st">'std_</span><span class="sc">%s</span><span class="st">_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (sample, scorer)]</span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a>        ax.fill_between(X_axis, sample_score_mean <span class="op">-</span> sample_score_std,</span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>                        sample_score_mean <span class="op">+</span> sample_score_std,</span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a>                        alpha<span class="op">=</span><span class="fl">0.1</span> <span class="cf">if</span> sample <span class="op">==</span> <span class="st">'test'</span> <span class="cf">else</span> <span class="dv">0</span>, color<span class="op">=</span>color)</span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a>        ax.plot(X_axis, sample_score_mean, style, color<span class="op">=</span>color,</span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="dv">1</span> <span class="cf">if</span> sample <span class="op">==</span> <span class="st">'test'</span> <span class="cf">else</span> <span class="fl">0.7</span>,</span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"</span><span class="sc">%s</span><span class="st"> (</span><span class="sc">%s</span><span class="st">)"</span> <span class="op">%</span> (scorer, sample))</span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a>    best_index <span class="op">=</span> np.nonzero(results[<span class="st">'rank_test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> scorer] <span class="op">==</span> <span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> <span class="op">-</span>results[<span class="st">'mean_test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> scorer][best_index] <span class="cf">if</span> scoring[scorer]<span class="op">==</span><span class="st">'neg_log_loss'</span> <span class="cf">else</span> results[<span class="st">'mean_test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> scorer][best_index]</span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot a dotted vertical line at the best score for that scorer marked by x</span></span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a>    ax.plot([X_axis[best_index], ] <span class="op">*</span> <span class="dv">2</span>, [<span class="dv">0</span>, best_score],</span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span><span class="st">'-.'</span>, color<span class="op">=</span>color, marker<span class="op">=</span><span class="st">'x'</span>, markeredgewidth<span class="op">=</span><span class="dv">3</span>, ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Annotate the best score for that scorer</span></span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a>    ax.annotate(<span class="st">"</span><span class="sc">%0.2f</span><span class="st">"</span> <span class="op">%</span> best_score,</span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a>                (X_axis[best_index], best_score <span class="op">+</span> <span class="fl">0.005</span>))</span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="st">'off'</span>)</span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>====================
best params: LogisticRegression(C=np.float64(2.50001), max_iter=5000)
best params: {'C': np.float64(2.50001)}
best score: 0.8069662921348316
====================</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-91-output-2.png" width="826" height="829" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="gridsearchcv-evaluating-using-multiple-scorers-repeatedstratifiedkfold-and-pipeline-for-preprocessing-simultaneously" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="gridsearchcv-evaluating-using-multiple-scorers-repeatedstratifiedkfold-and-pipeline-for-preprocessing-simultaneously"><span class="header-section-number">11.1</span> <code>GridSearchCV</code> Evaluating Using Multiple scorers, <code>RepeatedStratifiedKFold</code> and <code>pipeline</code> for Preprocessing Simultaneously</h3>
<div id="551f8260" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RepeatedStratifiedKFold</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Define simple model</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">###############################################################################</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.arange(<span class="fl">1e-05</span>, <span class="fl">5.5</span>, <span class="fl">0.1</span>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>scoring <span class="op">=</span> {<span class="st">'Accuracy'</span>: <span class="st">'accuracy'</span>, <span class="st">'AUC'</span>: <span class="st">'roc_auc'</span>, <span class="st">'Log_loss'</span>: <span class="st">'neg_log_loss'</span>}</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>log_reg <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">5000</span>)</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Simple pre-processing estimators</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">###############################################################################</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>std_scale <span class="op">=</span> StandardScaler(with_mean<span class="op">=</span><span class="va">False</span>, with_std<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co">#std_scale = StandardScaler()</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining the CV method: Using the Repeated Stratified K Fold</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="co">###############################################################################</span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>n_folds<span class="op">=</span><span class="dv">5</span></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>n_repeats<span class="op">=</span><span class="dv">5</span></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>rskfold <span class="op">=</span> RepeatedStratifiedKFold(n_splits<span class="op">=</span>n_folds, n_repeats<span class="op">=</span>n_repeats, random_state<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating simple pipeline and defining the gridsearch</span></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a><span class="co">###############################################################################</span></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>log_clf_pipe <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">'scale'</span>,std_scale), (<span class="st">'clf'</span>,log_reg)])</span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>log_clf <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>log_clf_pipe, cv<span class="op">=</span>rskfold,</span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a>              scoring<span class="op">=</span>scoring, return_train_score<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a>              param_grid<span class="op">=</span><span class="bu">dict</span>(clf__C<span class="op">=</span>C), refit<span class="op">=</span><span class="st">'Accuracy'</span>)</span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a>log_clf.fit(X, y)</span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> log_clf.cv_results_</span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'='</span><span class="op">*</span><span class="dv">20</span>)</span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"best params: "</span> <span class="op">+</span> <span class="bu">str</span>(log_clf.best_estimator_))</span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"best params: "</span> <span class="op">+</span> <span class="bu">str</span>(log_clf.best_params_))</span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'best score:'</span>, log_clf.best_score_)</span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'='</span><span class="op">*</span><span class="dv">20</span>)</span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV evaluating using multiple scorers simultaneously"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Inverse of regularization strength: C"</span>)</span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Score"</span>)</span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.axes()</span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, C.<span class="bu">max</span>()) </span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">0.35</span>, <span class="fl">0.95</span>)</span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the regular numpy array from the MaskedArray</span></span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a>X_axis <span class="op">=</span> np.array(results[<span class="st">'param_clf__C'</span>].data, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-56"><a href="#cb142-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> scorer, color <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">list</span>(scoring.keys()), [<span class="st">'g'</span>, <span class="st">'k'</span>, <span class="st">'b'</span>]): </span>
<span id="cb142-57"><a href="#cb142-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sample, style <span class="kw">in</span> ((<span class="st">'train'</span>, <span class="st">'--'</span>), (<span class="st">'test'</span>, <span class="st">'-'</span>)):</span>
<span id="cb142-58"><a href="#cb142-58" aria-hidden="true" tabindex="-1"></a>        sample_score_mean <span class="op">=</span> <span class="op">-</span>results[<span class="st">'mean_</span><span class="sc">%s</span><span class="st">_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (sample, scorer)] <span class="cf">if</span> scoring[scorer]<span class="op">==</span><span class="st">'neg_log_loss'</span> <span class="cf">else</span> results[<span class="st">'mean_</span><span class="sc">%s</span><span class="st">_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (sample, scorer)]</span>
<span id="cb142-59"><a href="#cb142-59" aria-hidden="true" tabindex="-1"></a>        sample_score_std <span class="op">=</span> results[<span class="st">'std_</span><span class="sc">%s</span><span class="st">_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (sample, scorer)]</span>
<span id="cb142-60"><a href="#cb142-60" aria-hidden="true" tabindex="-1"></a>        ax.fill_between(X_axis, sample_score_mean <span class="op">-</span> sample_score_std,</span>
<span id="cb142-61"><a href="#cb142-61" aria-hidden="true" tabindex="-1"></a>                        sample_score_mean <span class="op">+</span> sample_score_std,</span>
<span id="cb142-62"><a href="#cb142-62" aria-hidden="true" tabindex="-1"></a>                        alpha<span class="op">=</span><span class="fl">0.1</span> <span class="cf">if</span> sample <span class="op">==</span> <span class="st">'test'</span> <span class="cf">else</span> <span class="dv">0</span>, color<span class="op">=</span>color)</span>
<span id="cb142-63"><a href="#cb142-63" aria-hidden="true" tabindex="-1"></a>        ax.plot(X_axis, sample_score_mean, style, color<span class="op">=</span>color,</span>
<span id="cb142-64"><a href="#cb142-64" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="dv">1</span> <span class="cf">if</span> sample <span class="op">==</span> <span class="st">'test'</span> <span class="cf">else</span> <span class="fl">0.7</span>,</span>
<span id="cb142-65"><a href="#cb142-65" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"</span><span class="sc">%s</span><span class="st"> (</span><span class="sc">%s</span><span class="st">)"</span> <span class="op">%</span> (scorer, sample))</span>
<span id="cb142-66"><a href="#cb142-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-67"><a href="#cb142-67" aria-hidden="true" tabindex="-1"></a>    best_index <span class="op">=</span> np.nonzero(results[<span class="st">'rank_test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> scorer] <span class="op">==</span> <span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb142-68"><a href="#cb142-68" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> <span class="op">-</span>results[<span class="st">'mean_test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> scorer][best_index] <span class="cf">if</span> scoring[scorer]<span class="op">==</span><span class="st">'neg_log_loss'</span> <span class="cf">else</span> results[<span class="st">'mean_test_</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> scorer][best_index]</span>
<span id="cb142-69"><a href="#cb142-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb142-70"><a href="#cb142-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot a dotted vertical line at the best score for that scorer marked by x</span></span>
<span id="cb142-71"><a href="#cb142-71" aria-hidden="true" tabindex="-1"></a>    ax.plot([X_axis[best_index], ] <span class="op">*</span> <span class="dv">2</span>, [<span class="dv">0</span>, best_score],</span>
<span id="cb142-72"><a href="#cb142-72" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span><span class="st">'-.'</span>, color<span class="op">=</span>color, marker<span class="op">=</span><span class="st">'x'</span>, markeredgewidth<span class="op">=</span><span class="dv">3</span>, ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb142-73"><a href="#cb142-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-74"><a href="#cb142-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Annotate the best score for that scorer</span></span>
<span id="cb142-75"><a href="#cb142-75" aria-hidden="true" tabindex="-1"></a>    ax.annotate(<span class="st">"</span><span class="sc">%0.2f</span><span class="st">"</span> <span class="op">%</span> best_score,</span>
<span id="cb142-76"><a href="#cb142-76" aria-hidden="true" tabindex="-1"></a>                (X_axis[best_index], best_score <span class="op">+</span> <span class="fl">0.005</span>))</span>
<span id="cb142-77"><a href="#cb142-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-78"><a href="#cb142-78" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb142-79"><a href="#cb142-79" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="st">'off'</span>)</span>
<span id="cb142-80"><a href="#cb142-80" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>====================
best params: Pipeline(steps=[('scale', StandardScaler(with_mean=False, with_std=False)),
                ('clf',
                 LogisticRegression(C=np.float64(4.90001), max_iter=5000))])
best params: {'clf__C': np.float64(4.90001)}
best score: 0.7995505617977527
====================</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-92-output-2.png" width="826" height="829" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="regularization" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="regularization"><span class="header-section-number">12</span> Regularization</h2>
<p><code>Regularization</code> is a method of preventing overfitting, which is a common problem in machine learning. Overfitting means that your model learns too much from the specific data you have, and fails to generalize well to new or unseen data. This can lead to poor predictions and low performance. Regularization helps you avoid overfitting by adding a penalty term to the cost function of your model, which measures how well your model fits the data. The penalty term reduces the complexity of your model by shrinking or eliminating some of the coefficients of your input variables.</p>
<p>Since the size of each coefficient depends on the scale of its corresponding variable, scaling the data is required so that the regularization penalizes each variable equally. The regularization strength is determined by <code>C</code> and as <code>C</code> increases, the regularization term becomes smaller (and for extremely large <code>C</code> values, it’s as if there is no regularization at all).</p>
<p>If the initial model is overfit (as in, it fits the training data too well), then adding a strong regularization term (with small <code>C</code> value) makes the model perform worse for the training data, but introducing such “noise” improves the model’s performance on unseen (or test) data.</p>
<p>An example with 1000 samples and 200 features shown below. As can be seen from the plot of accuracy over different values of C, if C is large (with very little regularization), there is a big gap between how the model performs on training data and test data. However, as C decreases, the model performs worse on training data but performs better on test data (test accuracy increases). However, when C becomes too small (or the regularization becomes too strong), the model begins performing worse again because now the regularization term completely dominates the objective function.</p>
<div id="d05dcafd" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary Python Packages </span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make sample data</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_classification(<span class="dv">1000</span>, <span class="dv">200</span>, n_informative<span class="op">=</span><span class="dv">195</span>, random_state<span class="op">=</span><span class="dv">2023</span>)</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co"># split into train-test datasets</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, random_state<span class="op">=</span><span class="dv">2023</span>)</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize the data</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>sc <span class="op">=</span> StandardScaler()</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> sc.fit_transform(X_train)</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> sc.transform(X_test)</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="co"># train Logistic Regression models for different values of C</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a><span class="co"># and collect train and test accuracies</span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> {}</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> C <span class="kw">in</span> (<span class="dv">10</span><span class="op">**</span>k <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>)):</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>    lr <span class="op">=</span> LogisticRegression(C<span class="op">=</span>C)</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>    lr.fit(X_train, y_train)</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>    scores[C] <span class="op">=</span> {<span class="st">'train accuracy'</span>: lr.score(X_train, y_train), </span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'test accuracy'</span>: lr.score(X_test, y_test)}</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the accuracy scores for different values of C</span></span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>pd.DataFrame.from_dict(scores, <span class="st">'index'</span>).plot(logx<span class="op">=</span><span class="va">True</span>, xlabel<span class="op">=</span><span class="st">'C'</span>, ylabel<span class="op">=</span><span class="st">'accuracy'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_logistic_files/figure-html/cell-93-output-1.png" width="593" height="441" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="types-of-regularization" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="types-of-regularization"><span class="header-section-number">12.1</span> Types of Regularization</h3>
<section id="l1-regularization" class="level4" data-number="12.1.1">
<h4 data-number="12.1.1" class="anchored" data-anchor-id="l1-regularization"><span class="header-section-number">12.1.1</span> <code>L1</code> regularization</h4>
<p><code>L1</code> regularization, also known as <code>Lasso regularization</code>, adds the sum of the absolute values of the model’s coefficients to the loss function. It encourages sparsity in the model by shrinking some coefficients to precisely zero. This has the effect of performing feature selection, as the model can effectively ignore irrelevant or less important features. L1 regularization is particularly useful when dealing with high-dimensional datasets with desired feature selection.</p>
<p>Mathematically, the <code>L1</code> regularization term can be written as:</p>
<p><strong><code>L1 regularization = λ * Σ|wi|</code></strong></p>
<p>Here, <code>λ</code> is the regularization parameter that controls the strength of regularization, <code>wi</code> represents the individual model coefficients and the sum is taken over all coefficients.</p>
</section>
<section id="l2-regularization" class="level4" data-number="12.1.2">
<h4 data-number="12.1.2" class="anchored" data-anchor-id="l2-regularization"><span class="header-section-number">12.1.2</span> <code>L2</code> regularization</h4>
<p><code>L2</code> regularization, also known as <code>Ridge regularization</code>, adds the sum of the squared values of the model’s coefficients to the loss function. Unlike L1 regularization, L2 regularization does not force the coefficients to be exactly zero but instead encourages them to be small. L2 regularization can prevent overfitting by spreading the influence of a single feature across multiple features. It is advantageous when there are correlations between the input features.</p>
<p>Mathematically, the <code>L2</code> regularization term can be written as:</p>
<p><strong><code>L2 regularization = λ * Σ(wi^2)</code></strong></p>
<p>Similar to <code>L1</code> regularization, <code>λ</code> is the regularization parameter, and <code>wi</code> represents the model coefficients. The sum is taken over all coefficients, and the squares of the coefficients are summed.</p>
<p>The choice between <code>L1</code> and <code>L2</code> regularization depends on the specific problem and the characteristics of the data. For example, <code>L1</code> regularization produces sparse models, which can be advantageous when feature selection is desired. <code>L2</code> regularization, on the other hand, encourages small but non-zero coefficients and can be more suitable when there are strong correlations between features.</p>
</section>
</section>
</section>
<section id="conclusion" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">13</span> Conclusion</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chap03_knn.html" class="pagination-link" aria-label="<center> Chapter # 03 <br> K Nearest Neighbor (KNN) Algorithm">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"></span></a><center><a href="./chap03_knn.html" class="pagination-link" aria-label="<center> Chapter # 03 <br> K Nearest Neighbor (KNN) Algorithm"> Chapter # 03 <br> K Nearest Neighbor (KNN) Algorithm
      </a>          
  </center></div>
  <div class="nav-page nav-page-next">
      <a href="./chap05_discriminant.html" class="pagination-link" aria-label="<center> Chapter # 05 <br> Discriminant Analysis">
        <span class="nav-page-text"></span></a><center><a href="./chap05_discriminant.html" class="pagination-link" aria-label="<center> Chapter # 05 <br> Discriminant Analysis"> Chapter # 05 <br> Discriminant Analysis <i class="bi bi-arrow-right-short"></i>
      </a>
  </center></div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 The world's most valuable resource is no longer oil, but data (The Economist, 2017) <br> Copyright@2025, Sharif Islam, DBA, CPA, CMA
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
<p><img src="images/siuc2.png" class="img-fluid" width="100"></p>
</div>
  </div>
</footer>




</body></html>